<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="RayLiu" />

<meta name="date" content="2020-12-13" />

<title>Answers of StatComp Homework</title>

<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Answers of StatComp Homework</h1>
<h4 class="author">RayLiu</h4>
<h4 class="date">2020-12-13</h4>



<div id="overview" class="section level1">
<h1>Overview</h1>
<p><strong>StatComp20062</strong> also provides the homework answers for the ‘Statistical Computing’ course.</p>
<p>#Homework 1 ## Question</p>
<p>2.Use knitr to produce 3 examples in the book. The 1st example should contain texts and at least one figure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>1)The plot below is generated from the formula:<span class="math inline">\(\frac{1}{(1 + e^{-x+10})}\)</span> <img src="data:image/png;base64,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" /><!-- --></p>
<hr />
<p>2)The table below represents the cor matrix of the dataset “<em>rock</em>”</p>
<table class="table table-striped" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
area
</th>
<th style="text-align:right;">
peri
</th>
<th style="text-align:right;">
shape
</th>
<th style="text-align:right;">
perm
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
area
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.8225064
</td>
<td style="text-align:right;">
-0.1821611
</td>
<td style="text-align:right;">
-0.3966370
</td>
</tr>
<tr>
<td style="text-align:left;">
peri
</td>
<td style="text-align:right;">
0.8225064
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
-0.4331255
</td>
<td style="text-align:right;">
-0.7387158
</td>
</tr>
<tr>
<td style="text-align:left;">
shape
</td>
<td style="text-align:right;">
-0.1821611
</td>
<td style="text-align:right;">
-0.4331255
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.5567208
</td>
</tr>
<tr>
<td style="text-align:left;">
perm
</td>
<td style="text-align:right;">
-0.3966370
</td>
<td style="text-align:right;">
-0.7387158
</td>
<td style="text-align:right;">
0.5567208
</td>
<td style="text-align:right;">
1.0000000
</td>
</tr>
</tbody>
</table>
<hr />
<p>3)<span class="math inline">\(\mathbb{P}\)</span> is the probability measures on<span class="math inline">\((\mathbb{R},\mathscr{B})\)</span>,<span class="math inline">\(F(x)=\mathbb{P}((-\infty,x])\)</span>,We will give the definition of the distribution function:</p>
<ul>
<li><p><span class="math inline">\(F\)</span> is not descending</p></li>
<li><p><span class="math inline">\(\lim_{x \to -\infty}F(x)=0,\lim_{x \to \infty}F(x)=1\)</span></p></li>
<li><p><span class="math inline">\(F\)</span> is right continous,i.e.,<span class="math inline">\(\lim_{y \downarrow x}F(y)=F(x)\)</span></p></li>
</ul>
<p>#Homework 2 ## Question 3.3 The Pareto(a, b) distribution has cdf <span class="math display">\[F(x)=1-\left(\frac{b}{x} \right)^a,\qquad x\geqslant b&gt;0,a&gt;0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>solve the inverse function of Pareto distribution function <span class="math display">\[F^{-1}\left(u\right)=\frac{b}{(1-u)^{\frac{1}{a}}}\]</span> take in the parameters<span class="math inline">\(a=2,b=2\)</span> <span class="math display">\[F^{-1}\left(u\right)=\frac{2}{(1-y)^{\frac{1}{2}}}\]</span> the density of Pareto distribution <span class="math display">\[f(x)=\frac{ab^a}{x^{a+1}} \qquad x\geqslant b&gt;0,a&gt;0\]</span> <span class="math display">\[f(x)=\frac{8}{x^3}\]</span> generate the random number using inverse transformation method</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">a &lt;-<span class="st"> </span><span class="kw">set.seed</span>(<span class="fl">3.3</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb1-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb1-4" title="4">x &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>u)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="kw">range</span>(x)[<span class="dv">1</span>],<span class="kw">range</span>(x)[<span class="dv">2</span>],<span class="dt">length.out =</span> <span class="dv">31</span>),<span class="dt">main =</span> <span class="kw">bquote</span>(<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>y)),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">60</span>)) <span class="co">#density histogram of sample</span></a>
<a class="sourceLine" id="cb1-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">lines</span>(y, <span class="dv">8</span><span class="op">/</span>y<span class="op">^</span><span class="dv">3</span>) <span class="co">#density curve f(x)</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="question-3.9" class="section level2">
<h2>Question 3.9</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[\begin{equation}
    f_e\left(x\right)=\frac{3}{4}\left(1-x^2\right),\qquad\left| x\right|\leqslant 1  
    \end{equation}\]</span> <span class="math inline">\(Devroye\quad and\quad Gy\ddot orfi\)</span> [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1, U_2, U_3 ∼ U(−1, 1)\)</span>. If <span class="math inline">\(|U_3| \geqslant |U_2|\)</span> and <span class="math inline">\(|U_3| \geqslant |U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>according to the idea of <span class="math inline">\(Devroye\quad and\quad Gy\ddot orfi\)</span>, we can write the codes like below；</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">Epan &lt;-<span class="st"> </span><span class="cf">function</span>(n){</a>
<a class="sourceLine" id="cb2-2" title="2">  a &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-3" title="3">  b &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">  c &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-5" title="5">  d &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">abs</span>(c)<span class="op">&gt;=</span><span class="kw">abs</span>(a) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(c)<span class="op">&gt;=</span><span class="kw">abs</span>(b),b,c)</a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="kw">return</span>(d)</a>
<a class="sourceLine" id="cb2-7" title="7">}</a>
<a class="sourceLine" id="cb2-8" title="8"><span class="kw">set.seed</span>(<span class="fl">3.9</span>)</a>
<a class="sourceLine" id="cb2-9" title="9">x &lt;-<span class="st"> </span><span class="kw">Epan</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb2-10" title="10"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="kw">range</span>(x)[<span class="dv">1</span>],<span class="kw">range</span>(x)[<span class="dv">2</span>],<span class="dt">length.out =</span> <span class="dv">11</span>)) <span class="co">#density histogram of sample</span></a>
<a class="sourceLine" id="cb2-11" title="11">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw">lines</span>(y, <span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>) <span class="co">#density curve f(x)</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="question-3.10" class="section level2">
<h2>Question 3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span> .</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>proof：</p>
<p><span class="math display">\[\begin{align}           
&amp;\because U_1,U_2,U_3\sim U(-1,1)&amp;\\
&amp;\therefore|U_1|,|U_2|,|U_3|\sim U(0,1)&amp;
\end{align}\]</span> details:(take <span class="math inline">\(U_1\)</span> for example) <span class="math display">\[\begin{align} 
&amp;f(u_1)=\frac{1}{2},-1\leqslant u_1\leqslant 1\\
&amp;F(u_1)=\frac{1}{2}(x+1),-1\leqslant u_1\leqslant 1
\end{align}\]</span> <span class="math display">\[\begin{align}
F_{U_1}(x)
&amp;=P(|U_1|\leqslant x)&amp;\\
&amp;=P(-x\leqslant U_1\leqslant x)&amp;\\
&amp;=F_{U_1}(x)-F_{U_1}(-x)&amp;\\
&amp;=\frac{1}{2}(x+1)-\frac{1}{2}(-x+1)&amp;\\
&amp;=x&amp;\\
&amp;\therefore |U_i| \sim U(0,1),i=1,2,3
\end{align}\]</span> <span class="math display">\[\begin{align}
&amp;\because U_1,U_2,U_3 independent&amp;\\
&amp;\therefore we can get the joint density function of these three r.v. f_{U_1U_2U_3}(u_1,u_2,u_3)=\frac{1}{8},-1\leqslant u_1\leqslant 1,-1\leqslant u_2\leqslant 1,-1\leqslant u_3\leqslant 1&amp;\\
P(X\leqslant x)&amp;=P(X\leqslant x,X=U_2)+P(X\leqslant x,X=U_3)\\
&amp;=P(U_2\leqslant x,|U_3|\geqslant |U_2|,|U_3|\geqslant |U_1|)+P(U_3\leqslant x,|U_3|\leqslant |U_2|,|U_3|\geqslant |U_1|)+P(U_3\leqslant x,|U_3|\geqslant |U_2|,|U_3|\leqslant |U_1|)+P(U_3\leqslant x,|U_3|\leqslant |U_2|,|U_3|\leqslant |U_1|)\\
\end{align}\]</span> computing the probabilty of four situations respectively:</p>
<ul>
<li>1.<span class="math inline">\(P(U_2\leqslant x,|U_3|\geqslant |U_2|,|U_3|\geqslant |U_1|)\)</span>\ the prob of this space<span class="math inline">\(\{|U_3|\geqslant |U_2|,|U_3|\geqslant |U_1|\}\)</span> is:</li>
</ul>
<p><span class="math display">\[\begin{align}
P(|U_3|\geqslant |U_2|,|U_3|\geqslant |U_1|)&amp;=\iiint_{\mathcal D} \, d|u_1|\,d|u_2|\,d|u_3|\\
&amp;=\int_0^1\int_0^{|u_3|}\int_0^{|u_3|}\, d|u_1|\,d|u_2|\,d|u_3|\\
&amp;=\int_0^1\int_0^{z}\int_0^{z}\, dx\,dy\,dz\\
&amp;=\int_0^1 z^2\, dz\\
&amp;=\frac{1}{3}z^3|_0^1\\
&amp;=\frac{1}{3}
\end{align}\]</span></p>
<p>then, we computing the integral after removing the absolute value</p>
<p><span class="math display">\[\left\{
\begin{aligned}
U_1\leqslant |U_3|&amp;,and\\
U_1\geqslant -|U_3|
\end{aligned} \right.\quad \left\{
\begin{aligned}
U_3\geqslant |U_2|&amp;,or \\
U_3\leqslant -|U_2|
\end{aligned}\right.\]</span></p>
<p>discussing <span class="math inline">\(U_3\geqslant |U_2|\)</span> <span class="math display">\[\begin{align}
P(U_2\leqslant x,U_3\geqslant |U_2|,|U_3|\geqslant |U_1|)&amp;=\iiint_{\mathcal D}\frac{1}{8} \,du_1\,du_2\,du_3\\
&amp;=\int_{-1}^x\int_{|u_2|}^1\int_{-|u_3|}^{|u_3|}\frac{1}{8} \,du_1\,du_2\,du_3\\
&amp;=\int_{-1}^x\int_{|u_2|}^1\frac{1}{4}|u_3| \,du_1\,du_2\,du_3\\
&amp;=\int_{-1}^x\int_{|u_2|}^1\frac{1}{4}u_3 \,du_1\,du_2\,du_3\\
&amp;=\int_{-1}^x\frac{1}{8}u_3^2|_{|u_3|}^1 \,du_3\\
&amp;=\frac{1}{8}[x-\frac{1}{3}x^3+\frac{2}{3}]
\end{align}\]</span></p>
<p>discussing <span class="math inline">\(U_3\leqslant -|U_2|\)</span>,the result is as same,so <span class="math display">\[\begin{align}
P(U_2\leqslant x,|U_3|\geqslant |U_2|,|U_3|\geqslant |U_1|)&amp;=\frac{1}{8}[x-\frac{1}{3}x^3+\frac{2}{3}]\times 2\\
&amp;=\frac{1}{4}[x-\frac{1}{3}x^3+\frac{2}{3}]
\end{align}\]</span></p>
<ul>
<li>2.<span class="math inline">\(P(U_3\leqslant x,|U_3|&lt; |U_2|,|U_3|&lt; |U_1|)\)</span>\ the prob of this space<span class="math inline">\(\{|U_3|&lt; |U_2|,|U_3|&lt; |U_1|\}\)</span> is:(令<span class="math inline">\(X=|U_1|,Y=|U_2|,Z=|U_3|\)</span>)</li>
</ul>
<p><span class="math display">\[\begin{align}
P(|U_3|&lt; |U_2|,|U_3|&lt; |U_1|)&amp;=\iiint_{\mathcal D} \, d|u_1|\,d|u_2|\,d|u_3|\\
&amp;=\int_0^1\int_z^{1}\int_z^{1}\, dx\,dy\,dz\\
&amp;=\int_0^1 (1-z)^2\, dz\\
&amp;=z-z^2+\frac{1}{3}z^3|_0^1\\
&amp;=\frac{1}{3}
\end{align}\]</span></p>
<p>then, we computing the integral after removing the absolute value</p>
<p><span class="math display">\[\left\{
\begin{aligned}
U_1&gt; |U_3|&amp;,or\\
U_1&lt; -|U_3|
\end{aligned} \right.\quad \left\{
\begin{aligned}
U_2&gt; |U_3|&amp;,or\\
U_2&lt; -|U_3|
\end{aligned}\right.\]</span></p>
<p>discussing<span class="math inline">\(U_2&gt; |U_3|,U_1&gt; |U_3|\)</span> <span class="math display">\[\begin{align}
P(U_3\leqslant x,|U_3|&lt; U_2,|U_3|&lt; U_1)&amp;=\iiint_{\mathcal D}\frac{1}{8} \,du_1\,du_2\,du_3\\
&amp;=\int_{-1}^x\int_{|u_3|}^1\int_{|u_3|}^1\frac{1}{8} \,du_1\,du_2\,du_3\\
&amp;=\int_{-1}^x\frac{1}{8}(1-|u_3|)^2 \,du_3\\
&amp;=\left\{\begin{aligned}
&amp;\frac{1}{24}(1+x)^3&amp;,x&lt;0\\
&amp;\frac{1}{12}-\frac{1}{24}(1-x)^3&amp;,x\geqslant 0
\end{aligned} \right.\\
\end{align}\]</span></p>
<p>discussing the other three situations, finding the same results, so <span class="math display">\[\begin{align}
P(U_3\leqslant x,|U_3|&lt; |U_2|,|U_3|&lt; |U_1|)&amp;=4\times\left\{\begin{aligned}
&amp;\frac{1}{24}(1+x)^3&amp;,x&lt;0\\
&amp;\frac{1}{12}-\frac{1}{24}(1-x)^3&amp;,x\geqslant 0
\end{aligned} \right.\\
&amp;=\left\{\begin{aligned}
&amp;\frac{1}{6}(1+x)^3&amp;,x&lt;0\\
&amp;\frac{1}{3}-\frac{1}{6}(1-x)^3&amp;,x\geqslant 0
\end{aligned} \right.
\end{align}\]</span></p>
<ul>
<li>3.<span class="math inline">\(P(U_3\leqslant x,|U_3|&lt; |U_2|,|U_3|\geqslant |U_1|)\)</span>\ the prob of this space<span class="math inline">\(\{ |U_3|&lt; |U_2|,|U_3|\geqslant |U_1|\}\)</span> is:</li>
</ul>
<p><span class="math display">\[\begin{align}
P(|U_3|\geqslant |U_2|,|U_3|\geqslant |U_1|)&amp;=(1-\frac{1}{3}-\frac{1}{3})/2
&amp;=\frac{1}{6}
\end{align}\]</span></p>
<p>then, we computing the integral after removing the absolute value</p>
<p><span class="math display">\[\left\{
\begin{aligned}
U_1\leqslant |U_3|&amp;,and\\
U_1\geqslant -|U_3|
\end{aligned} \right.\quad \left\{
\begin{aligned}
U_2&gt; |U_3|&amp;,or\\
U_2&lt; -|U_3|
\end{aligned}\right.\]</span></p>
<p>discussing <span class="math inline">\(U_2&gt; |U_3|\)</span> <span class="math display">\[\begin{align}
P(U_3\leqslant x,|U_3|&lt; U_2,|U_3|\geqslant |U_1|)&amp;=\iiint_{\mathcal D}\frac{1}{8} \,du_1\,du_2\,du_3\\
&amp;=\int_{-1}^x\int_{|u_3|}^1\int_{-|u_3|}^{|u_3|}\frac{1}{8} \,du_1\,du_2\,du_3\\
&amp;=\int_{-1}^x\frac{1}{4}(1-|u_3|)|u_3| \,du_3\\
&amp;=\left\{\begin{aligned}
&amp;\frac{1}{24}-\frac{1}{8}x^2-\frac{1}{12}x^3&amp;,x&lt;0\\
&amp;\frac{1}{24}+\frac{1}{8}x^2-\frac{1}{12}x^3&amp;,x\geqslant 0
\end{aligned} \right.\\
\end{align}\]</span></p>
<p>we find the computing result of last situation is as same as before, so: <span class="math display">\[\begin{align}
P(U_3\leqslant x,|U_3|&lt; |U_2|,|U_3|\geqslant |U_1|)&amp;=2\times\left\{\begin{aligned}
&amp;\frac{1}{24}-\frac{1}{8}x^2-\frac{1}{12}x^3&amp;,x&lt;0\\
&amp;\frac{1}{24}+\frac{1}{8}x^2-\frac{1}{12}x^3&amp;,x\geqslant 0
\end{aligned} \right.\\
&amp;=\left\{\begin{aligned}
&amp;\frac{1}{12}-\frac{1}{4}x^2-\frac{1}{6}x^3&amp;,x&lt;0\\
&amp;\frac{1}{12}+\frac{1}{4}x^2-\frac{1}{6}x^3&amp;,x\geqslant 0
\end{aligned} \right.
\end{align}\]</span></p>
<ul>
<li>4.<span class="math inline">\(P(U_3\leqslant x,|U_3|\geqslant |U_2|,|U_3|&lt; |U_1|)\)</span> This situation is equal to 3.</li>
</ul>
<p>At all： <span class="math display">\[\begin{align}
P(X\leqslant x)&amp;=P(X\leqslant x,X=U_2)+P(X\leqslant x,X=U_3)\\
&amp;=P(U_2\leqslant x,|U_3|\geqslant |U_2|,|U_3|\geqslant |U_1|)+P(U_3\leqslant x,|U_3|\leqslant |U_2|,|U_3|\geqslant |U_1|)+P(U_3\leqslant x,|U_3|\geqslant |U_2|,|U_3|\leqslant |U_1|)+P(U_3\leqslant x,|U_3|\leqslant |U_2|,|U_3|\leqslant |U_1|)\\
&amp;=\frac{1}{4}[x-\frac{1}{3}x^3+\frac{2}{3}]+2\times\left\{\begin{aligned}
&amp;\frac{1}{12}-\frac{1}{4}x^2-\frac{1}{6}x^3&amp;,x&lt;0\\
&amp;\frac{1}{12}+\frac{1}{4}x^2-\frac{1}{6}x^3&amp;,x\geqslant 0
\end{aligned} \right.
+\left\{\begin{aligned}
&amp;\frac{1}{6}(1+x)^3&amp;,x&lt;0\\
&amp;\frac{1}{3}-\frac{1}{6}(1-x)^3&amp;,x\geqslant 0
\end{aligned} \right.\\
&amp;=\frac{3}{4}x-\frac{1}{4}x^3+\frac{1}{2},-1&lt;x&lt;1
\end{align}\]</span></p>
<p>solve the density function by distribution function <span class="math display">\[\begin{equation}
    f_e\left(x\right)=\frac{3}{4}\left(1-x^2\right),\qquad\left| x\right|\leqslant 1  
    \end{equation}\]</span></p>
<hr />
</div>
<div id="question-3.13" class="section level2">
<h2>Question 3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)= 1 − \left(\frac{\beta}{\beta+y}\right)^r,\qquad y\geqslant0. \]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(β = 2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>let us make use of the method3.12 to simulate the distribution where <span class="math inline">\(f(y)=r\beta^r(\beta+y)^{-r-1}\)</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">a &lt;-<span class="st"> </span><span class="kw">set.seed</span>(<span class="fl">3.13</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb3-3" title="3">ga &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">1000</span>,<span class="dv">4</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-4" title="4">y &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">1000</span>,ga)</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">hist</span>(y, <span class="dt">prob =</span> <span class="ot">TRUE</span>,<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="kw">range</span>(y)[<span class="dv">1</span>],<span class="kw">range</span>(y)[<span class="dv">2</span>],<span class="dt">length.out =</span> <span class="dv">31</span>),<span class="dt">main =</span> <span class="st">&quot;PARETO=GAMMA+exp(gamma)&quot;</span>) <span class="co">#density histogram of sample</span></a>
<a class="sourceLine" id="cb3-6" title="6">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">lines</span>(x, <span class="dv">4</span><span class="op">*</span><span class="dv">2</span><span class="op">^</span><span class="dv">4</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^-</span><span class="dv">5</span>) <span class="co">#density curve f(x)</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>#Homework 3 ## Question 5.1 Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\pi/3}\sin tdt\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li>Assign the number m.</li>
<li>Generate X1, . . .,Xm, iid from Uniform(0, <span class="math inline">\(\pi/3\)</span>).</li>
<li>Compute <span class="math inline">\(\hat\theta=\frac{1}{m}\sum_{i=1}^m(\frac{3}{\pi}\sin X_i)\)</span>.</li>
<li>Return <span class="math inline">\(\hat\theta\)</span> and accurate value.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">a &lt;-<span class="st"> </span><span class="kw">set.seed</span>(<span class="fl">5.1</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">m &lt;-<span class="st"> </span><span class="fl">1e4</span>; x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="op">-</span>(<span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)<span class="op">-</span><span class="kw">cos</span>(<span class="dv">0</span>))))</a></code></pre></div>
<pre><code>## [1] 0.5015958 0.5000000</code></pre>
<hr />
</div>
<div id="question-5.7" class="section level2">
<h2>Question 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">a &lt;-<span class="st"> </span><span class="kw">set.seed</span>(<span class="fl">5.7</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">m &lt;-<span class="st"> </span><span class="fl">1e5</span>; x &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb6-3" title="3">T1 &lt;-<span class="st"> </span><span class="kw">exp</span>(x)</a>
<a class="sourceLine" id="cb6-4" title="4">theta1.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(T1)<span class="co">#simple MC</span></a>
<a class="sourceLine" id="cb6-5" title="5">x2 &lt;-<span class="st"> </span>x[<span class="dv">1</span><span class="op">:</span>m<span class="op">/</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb6-6" title="6">T2 &lt;-<span class="st"> </span>(<span class="kw">exp</span>(x2)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x2))<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb6-7" title="7">theta2.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)<span class="co">#antithetic variate approach</span></a>
<a class="sourceLine" id="cb6-8" title="8">show &lt;-<span class="st"> </span><span class="kw">c</span>(theta1.hat,theta2.hat,<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw">names</span>(show) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SMC&quot;</span>,<span class="st">&quot;antithetic&quot;</span>,<span class="st">&quot;theoretical integral value&quot;</span>)</a>
<a class="sourceLine" id="cb6-10" title="10"><span class="kw">print</span>(show)</a></code></pre></div>
<pre><code>##                        SMC                 antithetic 
##                   1.715287                   1.718549 
## theoretical integral value 
##                   1.718282</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">eprv &lt;-<span class="st"> </span>(<span class="kw">var</span>(T1)<span class="op">-</span><span class="kw">var</span>(T2))<span class="op">/</span><span class="kw">var</span>(T1)</a>
<a class="sourceLine" id="cb8-2" title="2">var.g &lt;-<span class="st"> </span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span><span class="dv">2-1</span>)<span class="op">/</span><span class="dv">2</span><span class="op">-</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-3" title="3">var.theta &lt;-<span class="st"> </span>var.g<span class="op">/</span>m</a>
<a class="sourceLine" id="cb8-4" title="4">var.g1 &lt;-<span class="st"> </span>((<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">^</span><span class="dv">2-1</span>)<span class="op">/</span><span class="dv">2</span><span class="op">-</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span>(<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-5" title="5">var.theta1 &lt;-<span class="st"> </span>var.g1<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>m)</a>
<a class="sourceLine" id="cb8-6" title="6">tprv &lt;-<span class="st"> </span>(var.theta<span class="op">-</span><span class="st"> </span>var.theta1)<span class="op">/</span>var.theta</a>
<a class="sourceLine" id="cb8-7" title="7">show2 &lt;-<span class="st"> </span><span class="kw">c</span>(eprv,tprv)</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">names</span>(show2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;empirical prv&quot;</span>,<span class="st">&quot;theoretical prv&quot;</span>)</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw">print</span>(show2)</a></code></pre></div>
<pre><code>##   empirical prv theoretical prv 
##       0.9838786       0.9676701</code></pre>
<p>As the result show above, we know that:</p>
<ol style="list-style-type: decimal">
<li>The integral computing through antithetic method is closer to the true value the SMC.</li>
<li>Although the empirical estimate of the percentage reduction in variance is really close to the theoretical one given in the (5.6), it’s biased which needs to be concerned.</li>
</ol>
<hr />
</div>
<div id="question-5.11" class="section level2">
<h2>Question 5.11</h2>
<p>If <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are antithetic, we derived that c∗ = 1/2 is the optimal constant that minimizes the variance of <span class="math inline">\(\hat\theta_c = c\hatθ_1 + (1 − c)\hatθ_2\)</span>. Derive c∗ for the general case. That is, if <span class="math inline">\(\hat\theta_1\)</span> and <span class="math inline">\(\hat\theta_2\)</span> are any two unbiased estimators of θ, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat\theta_c = c\hatθ_1 + (1 − c)\hatθ_2\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>We try to rewrite the formula(5.11) and sort out the monomial that contains <span class="math inline">\(Var(\hat\theta_2)\)</span> , <span class="math inline">\(Var(\hat\theta_1)\)</span>and<span class="math inline">\(Cov(\hat\theta_2,\hat\theta_1)\)</span> respectively.</p>
<p><span class="math display">\[\begin{align}
&amp;Var(\hat\theta_2)+c^2Var(\hat\theta_1-\hat\theta_2)+2cCov(\hat\theta_2,\hat\theta_1-\hat\theta_2)\\
=&amp;Var(\hat\theta_2)(c-1)^2+Var(\hat\theta_1)c^2+Cov(\hat\theta_2,\hat\theta_1)2c(1-c)\\
=&amp;f(c)
\end{align}\]</span></p>
<p>We write the derivative function of <span class="math inline">\(f(c)\)</span> and solve it to find out the stationary point.</p>
<p><span class="math display">\[\begin{align}
f^{&#39;}(c)&amp;=2a(c-1)+2bc+2d(1-2c)\\
&amp;=(2a+2b-4d)c+2d-2a
\end{align}\]</span> In the formula, a,b and d represent <span class="math inline">\(Var(\hat\theta_2)\)</span> , <span class="math inline">\(Var(\hat\theta_1)\)</span>and<span class="math inline">\(Cov(\hat\theta_2,\hat\theta_1)\)</span>respectively.</p>
<p>Pay attention to the coefficient <span class="math inline">\(a+b-2d\)</span>, it’s always more than 0 unless <span class="math inline">\(\hat\theta_1\equiv\hat\theta_2\)</span>, because it means <span class="math inline">\(Var(\hat\theta_2)+Var(\hat\theta_1)-2Cov(\hat\theta_2,\hat\theta_1)=Var(\hat\theta_1-\hat\theta_2)\geqslant 0\)</span>. Variance is always no less than zero.</p>
<p>Thus, we can find the stationary point is <span class="math inline">\(c^*=\frac{a-d}{a+b-2d}=\frac{Var(\hat\theta_1)-Cov(\hat\theta_2,\hat\theta_1)}{Var(\hat\theta_1-\hat\theta_2)}\)</span>, which makes the<span class="math inline">\(\hat\theta^*_c\)</span> best.</p>
<p>#Homework 4 ## Question 5.13 Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((0,+\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^{+\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>We can find 2 importance functions exponetial distribution <span class="math display">\[f_1=\lambda e^{-\lambda x}\]</span> and gamma distribution <span class="math display">\[f_2=\frac{\beta^\alpha}{\Gamma(\alpha)}x^{\alpha-1}e^{-\beta x}\]</span> which are supported on <span class="math inline">\((0,+\infty)\)</span> To close <span class="math inline">\(g(x)\)</span>, we set the parameters <span class="math inline">\(\lambda=1,\alpha=4,\beta=2\)</span> and render the plot below</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">w &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb10-3" title="3">beta1 &lt;-<span class="st"> </span><span class="dv">2</span>;alpha &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb10-4" title="4">f1 &lt;-<span class="st"> </span><span class="kw">dexp</span>(x)</a>
<a class="sourceLine" id="cb10-5" title="5">f2 &lt;-<span class="st"> </span><span class="kw">dgamma</span>(x,<span class="dv">4</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-6" title="6">g &lt;-<span class="st"> </span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#figure (a)</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="kw">plot</span>(x, g, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb10-9" title="9"><span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">lwd =</span> w)</a>
<a class="sourceLine" id="cb10-10" title="10"><span class="kw">lines</span>(x, f1, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w)</a>
<a class="sourceLine" id="cb10-11" title="11"><span class="kw">lines</span>(x, f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w)</a>
<a class="sourceLine" id="cb10-12" title="12"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;g&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb10-13" title="13"><span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">#figure (b)</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">plot</span>(x, g<span class="op">/</span>f1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="dt">lwd =</span> w, <span class="dt">lty =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-4" title="4"><span class="kw">lines</span>(x, g<span class="op">/</span>f1, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> w)</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">lines</span>(x, g<span class="op">/</span>f2, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> w)</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb11-7" title="7"><span class="dt">lty =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> w, <span class="dt">inset =</span> <span class="fl">0.02</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> It seems that Gamma(4,2) is more like <span class="math inline">\(g(x)\)</span> than exp(1).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">m &lt;-<span class="st"> </span><span class="dv">100000</span></a>
<a class="sourceLine" id="cb12-2" title="2">theta.hat &lt;-<span class="st"> </span>var.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-3" title="3">gfun &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb12-4" title="4">x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">}</a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rexp</span>(m) <span class="co">#using f1</span></a>
<a class="sourceLine" id="cb12-8" title="8">fg &lt;-<span class="st"> </span><span class="kw">gfun</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dexp</span>(x)</a>
<a class="sourceLine" id="cb12-9" title="9">theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb12-10" title="10">var.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(fg)</a>
<a class="sourceLine" id="cb12-11" title="11"></a>
<a class="sourceLine" id="cb12-12" title="12">x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(m,<span class="dv">4</span>,<span class="dv">2</span>) <span class="co">#using f2</span></a>
<a class="sourceLine" id="cb12-13" title="13">fg &lt;-<span class="st"> </span><span class="kw">gfun</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dgamma</span>(x,<span class="dv">4</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-14" title="14">theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb12-15" title="15">var.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(fg)</a>
<a class="sourceLine" id="cb12-16" title="16"><span class="kw">rbind</span>(theta.hat, var.hat)</a></code></pre></div>
<pre><code>##                [,1]       [,2]
## theta.hat 0.4012479 0.39988471
## var.hat   0.3431719 0.06446159</code></pre>
<p>The simulation result shows that <span class="math inline">\(f_2\)</span> has smaller variance of 0.064 compared to that of <span class="math inline">\(f_1\)</span> of 0.341, which supports the idea that <span class="math inline">\(f_2\)</span> is more close to <span class="math inline">\(g\)</span>.</p>
<hr />
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>This method is called “Stratified Importance Sampling”, which firstly uses important function to make sure that <span class="math inline">\(g/f\)</span> is close to a constant, and then avails of the less variance in each straty.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">M &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb14-2" title="2">k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#number of strata</span></a>
<a class="sourceLine" id="cb14-3" title="3">r &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k <span class="co">#replicates per stratum</span></a>
<a class="sourceLine" id="cb14-4" title="4">N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></a>
<a class="sourceLine" id="cb14-5" title="5">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb14-6" title="6">estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb14-7" title="7">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb14-9" title="9">}</a>
<a class="sourceLine" id="cb14-10" title="10"></a>
<a class="sourceLine" id="cb14-11" title="11">q &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))<span class="co">#find the quantile</span></a>
<a class="sourceLine" id="cb14-12" title="12"></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb14-14" title="14">  estimates[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M)))</a>
<a class="sourceLine" id="cb14-15" title="15">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb14-16" title="16">    u &lt;-<span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span>k)   </a>
<a class="sourceLine" id="cb14-17" title="17">    x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>q[j]) <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)) <span class="op">/</span><span class="st"> </span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb14-18" title="18">    T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x)<span class="op">/</span>(<span class="dv">5</span><span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))))</a>
<a class="sourceLine" id="cb14-19" title="19">  }</a>
<a class="sourceLine" id="cb14-20" title="20">  estimates[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sum</span>(T2)</a>
<a class="sourceLine" id="cb14-21" title="21">}</a>
<a class="sourceLine" id="cb14-22" title="22">mean.est &lt;-<span class="st"> </span><span class="kw">apply</span>(estimates, <span class="dv">2</span>, mean)</a>
<a class="sourceLine" id="cb14-23" title="23">l &lt;-<span class="st"> </span>var.est &lt;-<span class="st"> </span><span class="kw">apply</span>(estimates, <span class="dv">2</span>, var)</a>
<a class="sourceLine" id="cb14-24" title="24">x_html &lt;-<span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">rbind</span>(mean.est,var.est),<span class="st">&quot;html&quot;</span>)</a>
<a class="sourceLine" id="cb14-25" title="25">kableExtra<span class="op">::</span><span class="kw">kable_styling</span>(x_html,<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb14-26" title="26">                          <span class="dt">full_width =</span> F,<span class="dt">font_size =</span> <span class="dv">14</span>)</a></code></pre></div>
<table class="table table-striped" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
mean.est
</td>
<td style="text-align:right;">
0.5252979
</td>
<td style="text-align:right;">
0.5247981
</td>
</tr>
<tr>
<td style="text-align:left;">
var.est
</td>
<td style="text-align:right;">
0.0000066
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
<p>It seems like that the variance has been reducted one more step using Stratified Importance Sampling compared with just Stratified Method.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">vrp &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>((l[<span class="dv">1</span>]<span class="op">-</span>l[<span class="dv">2</span>])<span class="op">/</span>l[<span class="dv">1</span>])<span class="co">#variance reduction</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">colnames</span>(vrp) &lt;-<span class="st"> &quot;vrp&quot;</span></a>
<a class="sourceLine" id="cb15-3" title="3">x_html &lt;-<span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>(vrp,<span class="st">&quot;html&quot;</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">kableExtra<span class="op">::</span><span class="kw">kable_styling</span>(x_html,<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</a>
<a class="sourceLine" id="cb15-5" title="5">                          <span class="dt">full_width =</span> F,<span class="dt">font_size =</span> <span class="dv">14</span>)</a></code></pre></div>
<table class="table table-striped" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
vrp
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.9931013
</td>
</tr>
</tbody>
</table>
We can find the percent reduction in variance is close to 100% compared to Stratified Method.
<table class="table table-striped" style="font-size: 14px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
f1
</th>
<th style="text-align:right;">
f2
</th>
<th style="text-align:right;">
f3
</th>
<th style="text-align:right;">
f4
</th>
<th style="text-align:right;">
f5
</th>
<th style="text-align:right;">
stratified
</th>
<th style="text-align:right;">
importance stratum
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
theta.hat
</td>
<td style="text-align:right;">
0.5241140
</td>
<td style="text-align:right;">
0.5313584
</td>
<td style="text-align:right;">
0.5461507
</td>
<td style="text-align:right;">
0.5250699
</td>
<td style="text-align:right;">
0.5260492
</td>
<td style="text-align:right;">
0.5252979
</td>
<td style="text-align:right;">
0.5247981
</td>
</tr>
<tr>
<td style="text-align:left;">
se
</td>
<td style="text-align:right;">
0.2436559
</td>
<td style="text-align:right;">
0.4181264
</td>
<td style="text-align:right;">
0.9661300
</td>
<td style="text-align:right;">
0.0965879
</td>
<td style="text-align:right;">
0.1427685
</td>
<td style="text-align:right;">
0.0025682
</td>
<td style="text-align:right;">
0.0002133
</td>
</tr>
</tbody>
</table>
<p>In sum, the Stratified Importance Sampling has the lowest standard deviation.</p>
<hr />
</div>
<div id="question-6.4" class="section level2">
<h2>Question 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,\dots,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>According to the properties of lognormal distribution, we have<span class="math inline">\(logX_i\sim N(\mu,\sigma^2)\)</span>, then <span class="math inline">\(\frac{1}{n}\sum_{i=1}^nlogX_i\sim N(\mu,\sigma^2/n)\)</span> using Central Limit Theorem. And <span class="math inline">\(\frac{1}{n}\sum_{i=1}^nlogX_i\)</span> is MLE of <span class="math inline">\(\mu\)</span> and unbiased. So we can create the confidence interval for the parameter <span class="math inline">\(\mu\)</span>: <span class="math display">\[(\frac{1}{n}\sum_{i=1}^nlogX_i\pm\frac{\sigma}{\sqrt{n}}z_{\alpha/2})\]</span> Because of the unknown parameter of <span class="math inline">\(\sigma\)</span> , we use its plug-in estimator. At the moment, the distribution of pivot estimator is t-distribution. <span class="math display">\[(\frac{1}{n}\sum_{i=1}^nlogX_i\pm\frac{\hat\sigma}{\sqrt{n}}t(n-1)_{\alpha/2})\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">set.seed</span>(<span class="fl">6.4</span>)</a>
<a class="sourceLine" id="cb16-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb16-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb16-4" title="4">calcCI &lt;-<span class="st"> </span><span class="cf">function</span>(n, alpha) {</a>
<a class="sourceLine" id="cb16-5" title="5">x &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb16-6" title="6"><span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">mean</span>(<span class="kw">log</span>(x)) <span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(x)) <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n),<span class="kw">mean</span>(<span class="kw">log</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(<span class="kw">log</span>(x)) <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)))</a>
<a class="sourceLine" id="cb16-7" title="7">}</a>
<a class="sourceLine" id="cb16-8" title="8">CL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> <span class="kw">calcCI</span>(n,alpha) )</a>
<a class="sourceLine" id="cb16-9" title="9"><span class="kw">mean</span>(<span class="dv">0</span><span class="op">&gt;</span>CL[<span class="dv">1</span>,] <span class="op">&amp;</span><span class="st"> </span><span class="dv">0</span><span class="op">&lt;</span>CL[<span class="dv">2</span>,])</a></code></pre></div>
<pre><code>## [1] 0.946</code></pre>
<p>This CI is really good.</p>
<hr />
</div>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use aMonte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p>the confidence interval for a mean is: <span class="math display">\[(\frac{1}{n}\sum_{i=1}^nX_i\pm\frac{s}{\sqrt{n}}t(n-1)_{\alpha/2})\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">set.seed</span>(<span class="fl">6.5</span>)</a>
<a class="sourceLine" id="cb18-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb18-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb18-4" title="4">calcCI &lt;-<span class="st"> </span><span class="cf">function</span>(n, alpha) {</a>
<a class="sourceLine" id="cb18-5" title="5">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-6" title="6"><span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n),<span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">*</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)))</a>
<a class="sourceLine" id="cb18-7" title="7">}</a>
<a class="sourceLine" id="cb18-8" title="8">CL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> <span class="kw">calcCI</span>(n,alpha) )</a>
<a class="sourceLine" id="cb18-9" title="9"><span class="kw">mean</span>(<span class="dv">2</span><span class="op">&gt;</span>CL[<span class="dv">1</span>,] <span class="op">&amp;</span><span class="st"> </span><span class="dv">2</span><span class="op">&lt;</span>CL[<span class="dv">2</span>,])</a></code></pre></div>
<pre><code>## [1] 0.93</code></pre>
<p>This CI is liberal, but compared to the results in Example 6.4 (empirical coverage probability=0.95), the result is not so bad which shows robust.</p>
<p>#Homework 5 ## Question 6.7 Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\upsilon)\)</span>?</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>First, let we look into how the symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions look like.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.005</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">plot</span>(x,<span class="kw">dbeta</span>(x,<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">3.8</span>),<span class="dt">ylab =</span> <span class="st">&quot;density&quot;</span>)</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb20-4" title="4">  <span class="kw">lines</span>(x,<span class="kw">dbeta</span>(x,i,i),<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span>i,<span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-5" title="5">}</a>
<a class="sourceLine" id="cb20-6" title="6"><span class="kw">legend</span>(<span class="fl">0.7</span>,<span class="dv">4</span>, <span class="dt">legend =</span> <span class="kw">paste</span>(<span class="st">&#39;a=&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">col =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then we’ll find that the power is less than 0.05 when <span class="math inline">\(\alpha\)</span> is among <span class="math inline">\([1,30]\)</span>, which shows that one can not tell a small sample is from whether a normal distribution or a symmetric beta distribution using the skewness test of normality.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb21-2" title="2">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb21-3" title="3">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb21-4" title="4">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-5" title="5">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb21-7" title="7">}<span class="co">#compute skewness of sample</span></a>
<a class="sourceLine" id="cb21-8" title="8"></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="kw">set.seed</span>(<span class="fl">6.71</span>)</a>
<a class="sourceLine" id="cb21-10" title="10">c.alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb21-11" title="11">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb21-12" title="12">m &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb21-13" title="13">pa.alpha &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">30</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-14" title="14"></a>
<a class="sourceLine" id="cb21-15" title="15">N &lt;-<span class="st"> </span><span class="kw">length</span>(pa.alpha)</a>
<a class="sourceLine" id="cb21-16" title="16">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb21-17" title="17"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb21-18" title="18">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>c.alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb21-19" title="19"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </a>
<a class="sourceLine" id="cb21-20" title="20">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb21-21" title="21">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb21-22" title="22">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, pa.alpha[j], pa.alpha[j])</a>
<a class="sourceLine" id="cb21-23" title="23">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb21-24" title="24">  }</a>
<a class="sourceLine" id="cb21-25" title="25">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb21-26" title="26">}</a>
<a class="sourceLine" id="cb21-27" title="27"></a>
<a class="sourceLine" id="cb21-28" title="28"><span class="kw">plot</span>(pa.alpha, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb21-29" title="29">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb21-30" title="30">     <span class="dt">main =</span> <span class="st">&quot;The power estimate of the skewness test of normality against Beta distributions&quot;</span>)</a>
<a class="sourceLine" id="cb21-31" title="31"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-32" title="32">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb21-33" title="33"><span class="kw">lines</span>(pa.alpha, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-34" title="34"><span class="kw">lines</span>(pa.alpha, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>However, the skewness test of normality can be used to tell whether a distribution belongs to t-distribution, especially when the degree of freedom is small. It may relate to its heavy tail feature.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat\alpha\dot=0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">set.seed</span>(<span class="fl">6.8</span>)</a>
<a class="sourceLine" id="cb22-2" title="2">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb22-3" title="3">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb22-4" title="4">power.c5 &lt;-<span class="st"> </span>power.f &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb22-5" title="5">sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb22-6" title="6">sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb22-7" title="7">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb22-8" title="8">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb22-9" title="9">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb22-10" title="10">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb22-11" title="11">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb22-12" title="12"><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb22-13" title="13"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb22-14" title="14">}</a>
<a class="sourceLine" id="cb22-15" title="15"></a>
<a class="sourceLine" id="cb22-16" title="16"><span class="co"># generate samples under H1 to estimate power</span></a>
<a class="sourceLine" id="cb22-17" title="17"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb22-18" title="18">  power.c5[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb22-19" title="19">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</a>
<a class="sourceLine" id="cb22-20" title="20">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</a>
<a class="sourceLine" id="cb22-21" title="21">  <span class="kw">count5test</span>(x, y)</a>
<a class="sourceLine" id="cb22-22" title="22">}))</a>
<a class="sourceLine" id="cb22-23" title="23">  power.f[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb22-24" title="24">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</a>
<a class="sourceLine" id="cb22-25" title="25">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</a>
<a class="sourceLine" id="cb22-26" title="26">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">var.test</span>(x,y,<span class="dt">conf.level =</span> <span class="fl">0.945</span>)<span class="op">$</span>p.value<span class="op">&lt;</span><span class="fl">0.055</span>))</a>
<a class="sourceLine" id="cb22-27" title="27">}))</a>
<a class="sourceLine" id="cb22-28" title="28">}</a>
<a class="sourceLine" id="cb22-29" title="29">power &lt;-<span class="st"> </span><span class="kw">cbind</span>(n,power.c5,power.f)</a>
<a class="sourceLine" id="cb22-30" title="30"><span class="kw">print</span>(power)</a></code></pre></div>
<pre><code>##        n power.c5 power.f
## [1,]  20   0.3142  0.4209
## [2,]  50   0.6569  0.8128
## [3,] 100   0.8485  0.9812</code></pre>
<p>We choose <span class="math inline">\(n=20,50,100\)</span> as small, medium, and large sample sizes respectively. It seems that F test performs better than Count five test when the samples are generated from normal distribution.</p>
<hr />
</div>
<div id="question-6.c" class="section level2">
<h2>Question 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If X and Y are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^n[(X_i-\bar X)^T\hat\Sigma^{-1}(X_j-\bar X)]^3\]</span> where <span class="math inline">\(\hat\Sigma\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<p>Repeat Examples 6.8</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">set.seed</span>(<span class="fl">6.81</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">d &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb24-3" title="3">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></a>
<a class="sourceLine" id="cb24-4" title="4">cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(.<span class="dv">95</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>) <span class="co">#crit. values for each n</span></a>
<a class="sourceLine" id="cb24-5" title="5">sk.mt &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb24-6" title="6">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb24-7" title="7">  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb24-8" title="8">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb24-9" title="9">  sigma &lt;-<span class="st"> </span><span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb24-10" title="10">  xcenter &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span>xbar</a>
<a class="sourceLine" id="cb24-11" title="11">  xsum &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">outer</span>(xcenter,xcenter,<span class="st">&quot;*&quot;</span>)<span class="op">/</span>sigma)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb24-12" title="12">  <span class="kw">return</span>( xsum<span class="op">/</span>n<span class="op">^</span><span class="dv">2</span> )</a>
<a class="sourceLine" id="cb24-13" title="13">}<span class="co">#1 dimension situation</span></a>
<a class="sourceLine" id="cb24-14" title="14"><span class="co">#n is a vector of sample sizes</span></a>
<a class="sourceLine" id="cb24-15" title="15"><span class="co">#we are doing length(n) different simulations</span></a>
<a class="sourceLine" id="cb24-16" title="16">p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></a>
<a class="sourceLine" id="cb24-17" title="17">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></a>
<a class="sourceLine" id="cb24-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</a>
<a class="sourceLine" id="cb24-19" title="19">sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></a>
<a class="sourceLine" id="cb24-20" title="20"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb24-21" title="21">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i])</a>
<a class="sourceLine" id="cb24-22" title="22"><span class="co">#test decision is 1 (reject) or 0</span></a>
<a class="sourceLine" id="cb24-23" title="23">sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">sk.mt</span>(x)<span class="op">*</span>n[i]<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv )</a>
<a class="sourceLine" id="cb24-24" title="24">}</a>
<a class="sourceLine" id="cb24-25" title="25">p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></a>
<a class="sourceLine" id="cb24-26" title="26">}</a>
<a class="sourceLine" id="cb24-27" title="27">p.reject</a></code></pre></div>
<pre><code>## [1] 0.0040 0.0241 0.0292 0.0384 0.0426 0.0449</code></pre>
<p>Compared to general skewness test of normality, Mardia’s multivariate skewness test also has the problem that when the sample size is small, it tends to underestimates the Type I error.</p>
<p>Repeat Examples 6.10</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">set.seed</span>(<span class="fl">6.101</span>)</a>
<a class="sourceLine" id="cb26-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.1</span></a>
<a class="sourceLine" id="cb26-3" title="3">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb26-4" title="4">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb26-5" title="5">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb26-6" title="6">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb26-7" title="7">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb26-9" title="9">cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(.<span class="dv">9</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb26-10" title="10"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb26-11" title="11">e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb26-12" title="12">sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb26-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb26-14" title="14">sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb26-15" title="15"><span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb26-16" title="16">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</a>
<a class="sourceLine" id="cb26-17" title="17">sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">sk.mt</span>(x)<span class="op">*</span>n<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv )</a>
<a class="sourceLine" id="cb26-18" title="18">}</a>
<a class="sourceLine" id="cb26-19" title="19">pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb26-20" title="20">}</a>
<a class="sourceLine" id="cb26-21" title="21"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb26-22" title="22"><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb26-23" title="23"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb26-24" title="24"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb26-25" title="25">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb26-26" title="26"><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb26-27" title="27"><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The whole curve is really like the one in Example 6.10, though the power curve does no longer cross the horizontal line corresponding to <span class="math inline">\(\alpha=0.10\)</span> at just both endpoints but 4 points in the plot.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p>We first repeat Example 6.8 which evaluate t1e rate of Mardia’s multivariate skewness test. In our simulation we generate variables following <span class="math inline">\(N(\mu,\Sigma)\)</span>, where: <span class="math display">\[\mu=(0,0,0)^{T} , \Sigma= \begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{bmatrix} \]</span></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb27-2" title="2">Mardia&lt;-<span class="cf">function</span>(mydata){</a>
<a class="sourceLine" id="cb27-3" title="3">  n=<span class="kw">nrow</span>(mydata)</a>
<a class="sourceLine" id="cb27-4" title="4">  c=<span class="kw">ncol</span>(mydata)</a>
<a class="sourceLine" id="cb27-5" title="5">  central&lt;-mydata</a>
<a class="sourceLine" id="cb27-6" title="6">  central &lt;-<span class="st"> </span><span class="kw">apply</span>(central,<span class="dv">2</span>,<span class="cf">function</span>(x) x<span class="op">-</span><span class="kw">mean</span>(x))</a>
<a class="sourceLine" id="cb27-7" title="7">  sigmah&lt;-<span class="kw">t</span>(central)<span class="op">%*%</span>central<span class="op">/</span>n</a>
<a class="sourceLine" id="cb27-8" title="8">  a&lt;-central<span class="op">%*%</span><span class="kw">solve</span>(sigmah)<span class="op">%*%</span><span class="kw">t</span>(central)</a>
<a class="sourceLine" id="cb27-9" title="9">  b&lt;-<span class="kw">sum</span>(a<span class="op">^</span>{<span class="dv">3</span>})<span class="op">/</span>(n<span class="op">*</span>n)</a>
<a class="sourceLine" id="cb27-10" title="10">  test&lt;-n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb27-11" title="11">  chi&lt;-<span class="kw">qchisq</span>(<span class="fl">0.95</span>,c<span class="op">*</span>(c<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(c<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</a>
<a class="sourceLine" id="cb27-12" title="12">  <span class="kw">as.integer</span>(test<span class="op">&gt;</span>chi)</a>
<a class="sourceLine" id="cb27-13" title="13">}</a>
<a class="sourceLine" id="cb27-14" title="14"></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb27-16" title="16">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb27-17" title="17">sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb27-18" title="18">m=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb27-19" title="19">n&lt;-<span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb27-20" title="20"><span class="co">#m: number of replicates; n: sample size</span></a>
<a class="sourceLine" id="cb27-21" title="21">a=<span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb27-22" title="22"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb27-23" title="23">  a[i]=<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb27-24" title="24">    mydata &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,sigma) </a>
<a class="sourceLine" id="cb27-25" title="25">    <span class="kw">Mardia</span>(mydata)</a>
<a class="sourceLine" id="cb27-26" title="26">  }))</a>
<a class="sourceLine" id="cb27-27" title="27">}</a></code></pre></div>
<p>We calculate the t1e when the sample size is 10, 20, 30, 50, 100, 500:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">print</span>(a)</a></code></pre></div>
<pre><code>## [1] 0.001 0.017 0.036 0.049 0.046 0.054</code></pre>
<p>From the result we can see that t1e rate is close to 0.05 after the sample size is large than 50.</p>
<p>We further repeat Example 6.8 which evaluate the power of Mardia’s multivariate skewness test under distribution <span class="math inline">\((1-\epsilon)N(\mu_{1},\Sigma_{1})+\epsilon N(\mu_{2},\Sigma_{2})\)</span>, where: <span class="math display">\[\mu_{1}=\mu_{2}=(0,0,0)^{T}, \Sigma_{1}=\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \end{bmatrix} 
\Sigma_{2}= \begin{bmatrix}
100 &amp; 0 &amp; 0 \\
0 &amp; 100 &amp; 0 \\
0 &amp; 0 &amp; 100 \end{bmatrix}\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">set.seed</span>(<span class="dv">7912</span>)</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="kw">set.seed</span>(<span class="dv">7912</span>)</a>
<a class="sourceLine" id="cb30-4" title="4">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-5" title="5">sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-6" title="6">sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-7" title="7">sigma=<span class="kw">list</span>(sigma1,sigma2)</a>
<a class="sourceLine" id="cb30-8" title="8">m=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb30-9" title="9">n=<span class="dv">50</span></a>
<a class="sourceLine" id="cb30-10" title="10"><span class="co">#m: number of replicates; n: sample size</span></a>
<a class="sourceLine" id="cb30-11" title="11">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.06</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb30-12" title="12">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb30-13" title="13">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb30-14" title="14"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb30-15" title="15">  e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb30-16" title="16">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb30-17" title="17">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb30-18" title="18">    index=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb30-19" title="19">    mydata&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>n,<span class="dt">ncol=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-20" title="20">    <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb30-21" title="21">      <span class="cf">if</span>(index[t]<span class="op">==</span><span class="dv">1</span>) mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu1,sigma1) </a>
<a class="sourceLine" id="cb30-22" title="22">      <span class="cf">else</span> mydata[t,]=<span class="kw">mvrnorm</span>(<span class="dv">1</span>,mu2,sigma2)</a>
<a class="sourceLine" id="cb30-23" title="23">    }</a>
<a class="sourceLine" id="cb30-24" title="24">    sktests[i] &lt;-<span class="st"> </span><span class="kw">Mardia</span>(mydata)</a>
<a class="sourceLine" id="cb30-25" title="25">  }</a>
<a class="sourceLine" id="cb30-26" title="26">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb30-27" title="27">}</a>
<a class="sourceLine" id="cb30-28" title="28"><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb30-29" title="29">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb30-30" title="30"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-31" title="31">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb30-32" title="32"><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-33" title="33"><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>When <span class="math inline">\(\epsilon=0\)</span> or <span class="math inline">\(\epsilon=1\)</span> the distribution is multinormal, when <span class="math inline">\(0\leq \epsilon \leq 1\)</span> the empirical power of the test is greater than 0.05 and highest(close to 1) when <span class="math inline">\(0.1\leq \epsilon \leq 0.3\)</span>.</p>
<hr />
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<ul>
<li><p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ul>
<li>What is the corresponding hypothesis test problem?</li>
<li>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</li>
<li>What information is needed to test your hypothesis?</li>
</ul></li>
</ul>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(H_0:\)</span>the powers for these two methods are not different. <span class="math inline">\(H_1:\)</span>the powers for these two methods are different.</p></li>
<li><p>We can use either Z-test, paired-t test or McNemar test. Note that the power computed from the two methods are highly closed and related, we could not use the two-sample t-test which requires the independence of two samples.</p></li>
<li><p>First we need every single result about whether accpted(0) or rejected(1) for two methods of the 10,000 experiments. For Z-test and paired-t test, we need to subtract the results number of each experiments, and then compute the mean and variance of the sample after subtraction. And then use the statistics below.</p></li>
</ol>
<p><span class="math display">\[\left| \frac{\bar D-(\mu_1-\mu_2)}{S/\sqrt n} \right |\geqslant t_{\alpha/2}(n-1)\]</span> or <span class="math display">\[\left| \frac{\bar D-(\mu_1-\mu_2)}{S/\sqrt n} \right |\geqslant z_{\alpha/2}\]</span> Where in this case we have <span class="math inline">\(\bar D=0\)</span>, <span class="math inline">\(S\)</span> represents the standard deviation of subtracted results of paired observations in the two samples.<span class="math inline">\(\mu_1=0.651, \mu_2=0.676\)</span>. Generally we take <span class="math inline">\(\alpha=0.05\)</span>.</p>
<p>For McNemar test, we need to assign numbers into 2*2 contingency table according to the results whether both methods are accepted, both are rejected or one is accepted while another is not. And then use the statistics below. <span class="math display">\[\frac{(b-c)^2}{b+c} \sim \chi^2(1)\]</span> Where b represents the total number of experiments that method A accepted while method B not, and c vice versa.</p>
<p>#Homework 6 ## Question 7.1 Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<p>The jackknife estimate of the bias of the correlation statistic is -0.00647. And the standard error of the correlation statistic is 0.1425.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">library</span>(bootstrap) <span class="co">#for the law data</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">data</span>(<span class="st">&quot;law&quot;</span>)</a>
<a class="sourceLine" id="cb31-3" title="3">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</a>
<a class="sourceLine" id="cb31-4" title="4">theta.hat &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</a>
<a class="sourceLine" id="cb31-5" title="5"><span class="co">##Estimate the bias</span></a>
<a class="sourceLine" id="cb31-6" title="6">theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb31-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb31-8" title="8">theta.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT[<span class="op">-</span>i], law<span class="op">$</span>GPA[<span class="op">-</span>i])</a>
<a class="sourceLine" id="cb31-9" title="9">bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</a>
<a class="sourceLine" id="cb31-10" title="10"><span class="co">##Estimate the standard error</span></a>
<a class="sourceLine" id="cb31-11" title="11">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb31-12" title="12"><span class="kw">print</span>(<span class="kw">list</span>(<span class="st">&quot;bias&quot;</span>=bias,<span class="st">&quot;se&quot;</span>=se))</a></code></pre></div>
<pre><code>## $bias
## [1] -0.006473623
## 
## $se
## [1] 0.1425186</code></pre>
<hr />
</div>
<div id="question-7.5" class="section level2">
<h2>Question 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<p>The induction of the MLE of the hazard rate λ presents below: <span class="math display">\[\begin{align}
\mathcal L(\lambda|x_i)&amp;=nlog\lambda-\lambda\sum_{i=1}^nx_i\\
\mathcal L^{&#39;}(\lambda|x_i)&amp;=\frac{n}{\lambda}-\sum_{i=1}^nx_i=0\\
\therefore\hat\lambda&amp;=\frac{1}{\bar X}
\end{align}
\]</span> Thus, the mean time between failures <span class="math inline">\(1/\lambda\)</span> can be computed by <span class="math inline">\(\bar X\)</span></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">data</span>(<span class="st">&quot;aircondit&quot;</span>)</a>
<a class="sourceLine" id="cb33-3" title="3">hour &lt;-<span class="st"> </span>aircondit<span class="op">$</span>hours</a>
<a class="sourceLine" id="cb33-4" title="4">lambda.boot &lt;-<span class="st"> </span><span class="cf">function</span>(dat,ind){</a>
<a class="sourceLine" id="cb33-5" title="5">  y &lt;-<span class="st"> </span>dat[ind]</a>
<a class="sourceLine" id="cb33-6" title="6">  <span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb33-7" title="7">}</a>
<a class="sourceLine" id="cb33-8" title="8">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> hour,<span class="dt">statistic =</span> lambda.boot, <span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb33-9" title="9"><span class="kw">print</span>(boot.obj)</a></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = hour, statistic = lambda.boot, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original  bias    std. error
## t1* 108.0833    0.91    38.21103</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">conf =</span> <span class="fl">0.95</span>) )</a></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, conf = 0.95)
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 32.3, 182.1 )   ( 24.4, 169.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.5, 191.7 )   ( 55.4, 218.2 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">hist</span>(boot.obj<span class="op">$</span>t)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>All four intervals cover the the mean <span class="math inline">\(\frac{1}{\lambda}=108.08\)</span> of time between failures. One reason for the difference in the percentile and normal confidence intervals could be that the sampling distribution of mean statistic is not close to normal (see the histogram). When the sampling distribution of the statistic is approximately normal, the percentile interval will agree with the normal interval.</p>
<p>It seems that BCa confidence intervals are more deviated from normal confidence intervals, which induces constant variance <span class="math inline">\(\sigma^2(\hat\theta)\)</span> possibly depend on the parameter <span class="math inline">\(\theta\)</span>. It make sense because population distribution seems like exponential distribution which are explained in Exercise 7.4. As for exponential distribution, its expectation equals to its variance.</p>
<hr />
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">data</span>(<span class="st">&quot;scor&quot;</span>)</a>
<a class="sourceLine" id="cb38-2" title="2">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb38-3" title="3"></a>
<a class="sourceLine" id="cb38-4" title="4">Contribution&lt;-<span class="cf">function</span>(mydata){</a>
<a class="sourceLine" id="cb38-5" title="5">  n=<span class="kw">nrow</span>(mydata)</a>
<a class="sourceLine" id="cb38-6" title="6">  c=<span class="kw">ncol</span>(mydata)</a>
<a class="sourceLine" id="cb38-7" title="7">  central&lt;-mydata</a>
<a class="sourceLine" id="cb38-8" title="8">  central &lt;-<span class="st"> </span><span class="kw">apply</span>(central,<span class="dv">2</span>,<span class="cf">function</span>(x) x<span class="op">-</span><span class="kw">mean</span>(x))</a>
<a class="sourceLine" id="cb38-9" title="9">  sigmah&lt;-<span class="kw">t</span>(central)<span class="op">%*%</span>central<span class="op">/</span>n</a>
<a class="sourceLine" id="cb38-10" title="10">  eigenh &lt;-<span class="st"> </span><span class="kw">eigen</span>(sigmah)</a>
<a class="sourceLine" id="cb38-11" title="11">  theta.hat &lt;-<span class="st"> </span>eigenh<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eigenh<span class="op">$</span>values)</a>
<a class="sourceLine" id="cb38-12" title="12">  theta.hat</a>
<a class="sourceLine" id="cb38-13" title="13">}</a>
<a class="sourceLine" id="cb38-14" title="14"></a>
<a class="sourceLine" id="cb38-15" title="15">theta.hat &lt;-<span class="st"> </span><span class="kw">Contribution</span>(scor)</a>
<a class="sourceLine" id="cb38-16" title="16">theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb38-17" title="17"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb38-18" title="18">theta.jack[i] &lt;-<span class="st"> </span><span class="kw">Contribution</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb38-19" title="19">bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</a>
<a class="sourceLine" id="cb38-20" title="20"><span class="co">##Estimate the standard error</span></a>
<a class="sourceLine" id="cb38-21" title="21">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb38-22" title="22"><span class="kw">print</span>(<span class="kw">list</span>(<span class="st">&quot;bias&quot;</span>=bias,<span class="st">&quot;se&quot;</span>=se))</a></code></pre></div>
<pre><code>## $bias
## [1] 0.001069139
## 
## $se
## [1] 0.04955231</code></pre>
<p>The jackknife estimate of the bias of <span class="math inline">\(\hat\theta\)</span> is 0.00106. And the standard error of <span class="math inline">\(\hat\theta\)</span> is 0.0496.</p>
<pre><code>## [1] 0.0007836621</code></pre>
<p>Compared to bootstrap method, the bias of <span class="math inline">\(\hat\theta\)</span> is similar.</p>
<hr />
</div>
<div id="section" class="section level2">
<h2>7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb41-2" title="2">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb41-3" title="3"></a>
<a class="sourceLine" id="cb41-4" title="4">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb41-5" title="5">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb41-6" title="6"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb41-7" title="7"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)) {</a>
<a class="sourceLine" id="cb41-9" title="9">  <span class="cf">for</span> (j <span class="cf">in</span> (k<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb41-10" title="10">    y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(k,j)]</a>
<a class="sourceLine" id="cb41-11" title="11">    x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(k,j)]</a>
<a class="sourceLine" id="cb41-12" title="12">    </a>
<a class="sourceLine" id="cb41-13" title="13">    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb41-14" title="14">    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)]</a>
<a class="sourceLine" id="cb41-15" title="15">    e1[k] &lt;-<span class="st"> </span>e1[k] <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat1)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb41-16" title="16">    </a>
<a class="sourceLine" id="cb41-17" title="17">    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb41-18" title="18">    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)] <span class="op">+</span></a>
<a class="sourceLine" id="cb41-19" title="19"><span class="st">      </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb41-20" title="20">    e2[k] &lt;-<span class="st"> </span>e2[k] <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat2)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb41-21" title="21">    </a>
<a class="sourceLine" id="cb41-22" title="22">    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb41-23" title="23">    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[<span class="kw">c</span>(k,j)]</a>
<a class="sourceLine" id="cb41-24" title="24">    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb41-25" title="25">    e3[k] &lt;-<span class="st"> </span>e3[k] <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat3)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb41-26" title="26">    </a>
<a class="sourceLine" id="cb41-27" title="27">    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb41-28" title="28">    logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[<span class="kw">c</span>(k,j)])</a>
<a class="sourceLine" id="cb41-29" title="29">    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</a>
<a class="sourceLine" id="cb41-30" title="30">    e4[k] &lt;-<span class="st"> </span>e4[k] <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>((magnetic[<span class="kw">c</span>(k,j)] <span class="op">-</span><span class="st"> </span>yhat4)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb41-31" title="31">  }</a>
<a class="sourceLine" id="cb41-32" title="32">}</a>
<a class="sourceLine" id="cb41-33" title="33">t &lt;-<span class="st"> </span>n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb41-34" title="34"><span class="kw">c</span>(<span class="kw">sum</span>(e1)<span class="op">/</span>t,<span class="kw">sum</span>(e2)<span class="op">/</span>t,<span class="kw">sum</span>(e3)<span class="op">/</span>t,<span class="kw">sum</span>(e4)<span class="op">/</span>t)</a></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<p>In Example 7.18, leave-one-out (<span class="math inline">\(n\)</span>-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">library</span>(DAAG)</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">attach</span>(ironslag)</a></code></pre></div>
<pre><code>## The following objects are masked from ironslag (pos = 3):
## 
##     chemical, magnetic</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic)</a>
<a class="sourceLine" id="cb45-2" title="2">e1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-3" title="3">e2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-4" title="4">e3 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-5" title="5">e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-6" title="6">count &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb45-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb45-8" title="8">  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb45-9" title="9">    count &lt;-<span class="st"> </span>count<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb45-10" title="10">    y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span><span class="kw">c</span>(i,j)]</a>
<a class="sourceLine" id="cb45-11" title="11">    x &lt;-<span class="st"> </span>chemical[<span class="op">-</span><span class="kw">c</span>(i,j)]</a>
<a class="sourceLine" id="cb45-12" title="12">    </a>
<a class="sourceLine" id="cb45-13" title="13">    P1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</a>
<a class="sourceLine" id="cb45-14" title="14">    y1_<span class="dv">1</span> &lt;-<span class="st"> </span>chemical[i]<span class="op">*</span>P1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>P1<span class="op">$</span>coef[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb45-15" title="15">    y1_<span class="dv">2</span> &lt;-<span class="st"> </span>chemical[j]<span class="op">*</span>P1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>P1<span class="op">$</span>coef[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb45-16" title="16">    e1[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y1_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y1_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb45-17" title="17">    </a>
<a class="sourceLine" id="cb45-18" title="18">    P2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb45-19" title="19">    y2_<span class="dv">1</span> &lt;-<span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[i]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb45-20" title="20">    y2_<span class="dv">2</span> &lt;-<span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j] <span class="op">+</span><span class="st"> </span>P2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[j]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb45-21" title="21">    e2[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y2_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y2_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb45-22" title="22">    </a>
<a class="sourceLine" id="cb45-23" title="23">    P3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span>x)</a>
<a class="sourceLine" id="cb45-24" title="24">    y3_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[i])</a>
<a class="sourceLine" id="cb45-25" title="25">    y3_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[j])</a>
<a class="sourceLine" id="cb45-26" title="26">    e3[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y3_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y3_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb45-27" title="27">    </a>
<a class="sourceLine" id="cb45-28" title="28">    P4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y)<span class="op">~</span><span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb45-29" title="29">    y4_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[i]))</a>
<a class="sourceLine" id="cb45-30" title="30">    y4_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">exp</span>(P4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>P4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[j]))</a>
<a class="sourceLine" id="cb45-31" title="31">    e4[count] &lt;-<span class="st"> </span>(magnetic[i]<span class="op">-</span>y4_<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">+</span>(magnetic[j]<span class="op">-</span>y4_<span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb45-32" title="32">  }</a>
<a class="sourceLine" id="cb45-33" title="33"></a>
<a class="sourceLine" id="cb45-34" title="34">e =<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(e1)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e2)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e3)<span class="op">/</span><span class="dv">2</span>,<span class="kw">mean</span>(e4)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-35" title="35"><span class="kw">matrix</span>(e, <span class="dt">nrow=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb45-36" title="36">       <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="st">&quot;prediction error&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Linear&quot;</span>,<span class="st">&quot;Quadratic&quot;</span>,<span class="st">&quot; Exponential&quot;</span>,<span class="st">&quot;Log-Log&quot;</span>)))</a></code></pre></div>
<pre><code>##                    Linear Quadratic  Exponential  Log-Log
## prediction error 19.57227  17.87018     18.45491 20.46718</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">detach</span>(ironslag)</a></code></pre></div>
<p>#Homework 7 ## Question 8.3 The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>We can use the permutation method to select a subset whose size is equal to the small one, from the larger size sample. And then use the Count5 Test.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb48-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb48-3" title="3">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb48-4" title="4">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb48-5" title="5">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb48-6" title="6">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb48-7" title="7">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb48-8" title="8">  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb48-9" title="9">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb48-10" title="10">}</a>
<a class="sourceLine" id="cb48-11" title="11"></a>
<a class="sourceLine" id="cb48-12" title="12">permC &lt;-<span class="st"> </span><span class="cf">function</span>(n1,n2,<span class="dt">mu1=</span><span class="dv">0</span>,<span class="dt">mu2=</span><span class="dv">0</span>,<span class="dt">sigma1=</span><span class="dv">1</span>,<span class="dt">sigma2=</span><span class="dv">1</span>,<span class="dt">R =</span> <span class="dv">100</span>){</a>
<a class="sourceLine" id="cb48-13" title="13">  <span class="cf">if</span>(n1<span class="op">&gt;</span>n2)<span class="kw">stop</span>(<span class="st">&quot;n1 should be less than n2&quot;</span>)</a>
<a class="sourceLine" id="cb48-14" title="14">  reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb48-15" title="15">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1,mu1,sigma1)</a>
<a class="sourceLine" id="cb48-16" title="16">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2,mu2,sigma2)</a>
<a class="sourceLine" id="cb48-17" title="17">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb48-18" title="18">    <span class="co">#generate indices k for the first sample</span></a>
<a class="sourceLine" id="cb48-19" title="19">    k &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n2, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb48-20" title="20">    x1 &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb48-21" title="21">    y1 &lt;-<span class="st"> </span>y[k] <span class="co">#complement of x1</span></a>
<a class="sourceLine" id="cb48-22" title="22">    reps[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1, y1)</a>
<a class="sourceLine" id="cb48-23" title="23">  }</a>
<a class="sourceLine" id="cb48-24" title="24">  <span class="kw">mean</span>(reps)</a>
<a class="sourceLine" id="cb48-25" title="25">}</a>
<a class="sourceLine" id="cb48-26" title="26"></a>
<a class="sourceLine" id="cb48-27" title="27">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb48-28" title="28">n2 &lt;-<span class="st"> </span><span class="dv">40</span></a>
<a class="sourceLine" id="cb48-29" title="29">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb48-30" title="30">alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span><span class="kw">permC</span>(n1,n2)))</a>
<a class="sourceLine" id="cb48-31" title="31"><span class="kw">print</span>(alphahat)</a></code></pre></div>
<pre><code>## [1] 0.05356</code></pre>
<p>It’s really clsoe to the significance level 0.05.</p>
<hr />
</div>
<div id="discussionequal-disttribution-test" class="section level2">
<h2>Discussion(Equal disttribution test)</h2>
<ul>
<li>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.
<ul>
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</li>
</ul></li>
</ul>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li>We can generate random X and Y from these two distribution below like: <span class="math inline">\(X\sim N(\mu_1,\Sigma_1)\)</span>, <span class="math inline">\(Y\sim N(\mu_2,\Sigma_2)\)</span> assuming they have Unequal variances and equal expectations</li>
</ol>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb50-2" title="2"><span class="kw">library</span>(RANN)</a>
<a class="sourceLine" id="cb50-3" title="3"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb50-4" title="4"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb50-5" title="5"></a>
<a class="sourceLine" id="cb50-6" title="6">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb50-7" title="7">sim &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">41</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb50-8" title="8"></a>
<a class="sourceLine" id="cb50-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">40</span>) {</a>
<a class="sourceLine" id="cb50-10" title="10">  epsilon &lt;-<span class="st"> </span>(i<span class="op">+</span><span class="dv">10</span>)<span class="op">*</span>.<span class="dv">1</span></a>
<a class="sourceLine" id="cb50-11" title="11">  mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb50-12" title="12">sigma1 &lt;-<span class="st"> </span>epsilon<span class="op">*</span><span class="kw">diag</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb50-13" title="13">mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb50-14" title="14">sigma2 &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb50-15" title="15">X &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dv">40</span>,mu1,sigma1)</a>
<a class="sourceLine" id="cb50-16" title="16">Y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dv">40</span>,mu2,sigma2)</a>
<a class="sourceLine" id="cb50-17" title="17"></a>
<a class="sourceLine" id="cb50-18" title="18"><span class="co">#NN test</span></a>
<a class="sourceLine" id="cb50-19" title="19">Z &lt;-<span class="st"> </span><span class="kw">rbind</span>(X, Y)</a>
<a class="sourceLine" id="cb50-20" title="20">Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</a>
<a class="sourceLine" id="cb50-21" title="21">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb50-22" title="22">  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb50-23" title="23">  z &lt;-<span class="st"> </span>z[ix, ];</a>
<a class="sourceLine" id="cb50-24" title="24">  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></a>
<a class="sourceLine" id="cb50-25" title="25">  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb50-26" title="26">  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb50-27" title="27">  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</a>
<a class="sourceLine" id="cb50-28" title="28">  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb50-29" title="29">}</a>
<a class="sourceLine" id="cb50-30" title="30"><span class="kw">set.seed</span>(<span class="dv">12345</span>); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">nrow</span>(X), <span class="kw">nrow</span>(Y))</a>
<a class="sourceLine" id="cb50-31" title="31">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb50-32" title="32">                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N,<span class="dt">k=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb50-33" title="33">ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb50-34" title="34">p.value1 &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb50-35" title="35"></a>
<a class="sourceLine" id="cb50-36" title="36"><span class="co">#energy test</span></a>
<a class="sourceLine" id="cb50-37" title="37">boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(Z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb50-38" title="38">p.value2 &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb50-39" title="39"></a>
<a class="sourceLine" id="cb50-40" title="40"><span class="co">#ball test</span></a>
<a class="sourceLine" id="cb50-41" title="41">p.value3 =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y, <span class="dt">num.permutations =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb50-42" title="42"></a>
<a class="sourceLine" id="cb50-43" title="43">p &lt;-<span class="st"> </span><span class="kw">c</span>(p.value1,p.value2,p.value3<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb50-44" title="44"><span class="kw">names</span>(p) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;energy test&#39;</span>,<span class="st">&#39;ball test&#39;</span>)</a>
<a class="sourceLine" id="cb50-45" title="45">sim[i<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(epsilon,p)</a>
<a class="sourceLine" id="cb50-46" title="46">}</a>
<a class="sourceLine" id="cb50-47" title="47"> </a>
<a class="sourceLine" id="cb50-48" title="48"><span class="kw">plot</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">2</span>], <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb50-49" title="49"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>)</a>
<a class="sourceLine" id="cb50-50" title="50"><span class="kw">lines</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb50-51" title="51"><span class="kw">lines</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">4</span>], <span class="dt">lty =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb50-52" title="52"><span class="kw">abline</span>(<span class="dt">h =</span> alpha, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb50-53" title="53"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dv">1</span>, <span class="kw">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;energy test&#39;</span>,<span class="st">&#39;ball test&#39;</span>),</a>
<a class="sourceLine" id="cb50-54" title="54"><span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="dt">inset =</span> <span class="fl">.02</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The p-value of all test are significant, and it seems ball test performs better.</p>
<ol start="2" style="list-style-type: decimal">
<li>We can generate random X and Y from these two distribution below like: <span class="math inline">\(X\sim N(\mu_1,\Sigma_1)\)</span>, <span class="math inline">\(Y\sim N(\mu_2,\Sigma_2)\)</span> assuming they have Unequal variances and unequal expectations</li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">sim &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">41</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb51-2" title="2"></a>
<a class="sourceLine" id="cb51-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">40</span>) {</a>
<a class="sourceLine" id="cb51-4" title="4">  epsilon &lt;-<span class="st"> </span>(i<span class="op">+</span><span class="dv">40</span>)<span class="op">*</span>.<span class="dv">025</span></a>
<a class="sourceLine" id="cb51-5" title="5">  mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(epsilon<span class="dv">-1</span>,<span class="dv">2</span><span class="op">*</span>(epsilon<span class="dv">-1</span>))</a>
<a class="sourceLine" id="cb51-6" title="6">sigma1 &lt;-<span class="st"> </span>epsilon<span class="op">*</span><span class="kw">diag</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb51-7" title="7">mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb51-8" title="8">sigma2 &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb51-9" title="9">X &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dv">40</span>,mu1,sigma1)</a>
<a class="sourceLine" id="cb51-10" title="10">Y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dv">40</span>,mu2,sigma2)</a>
<a class="sourceLine" id="cb51-11" title="11"></a>
<a class="sourceLine" id="cb51-12" title="12"><span class="co">#NN test</span></a>
<a class="sourceLine" id="cb51-13" title="13">Z &lt;-<span class="st"> </span><span class="kw">rbind</span>(X, Y)</a>
<a class="sourceLine" id="cb51-14" title="14">Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</a>
<a class="sourceLine" id="cb51-15" title="15">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb51-16" title="16">  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb51-17" title="17">  z &lt;-<span class="st"> </span>z[ix, ];</a>
<a class="sourceLine" id="cb51-18" title="18">  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></a>
<a class="sourceLine" id="cb51-19" title="19">  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb51-20" title="20">  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb51-21" title="21">  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</a>
<a class="sourceLine" id="cb51-22" title="22">  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb51-23" title="23">}</a>
<a class="sourceLine" id="cb51-24" title="24"><span class="kw">set.seed</span>(<span class="dv">12345</span>); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">nrow</span>(X), <span class="kw">nrow</span>(Y))</a>
<a class="sourceLine" id="cb51-25" title="25">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb51-26" title="26">                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N,<span class="dt">k=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb51-27" title="27">ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb51-28" title="28">p.value1 &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb51-29" title="29"></a>
<a class="sourceLine" id="cb51-30" title="30"><span class="co">#energy test</span></a>
<a class="sourceLine" id="cb51-31" title="31">boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(Z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb51-32" title="32">p.value2 &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb51-33" title="33"></a>
<a class="sourceLine" id="cb51-34" title="34"><span class="co">#ball test</span></a>
<a class="sourceLine" id="cb51-35" title="35">p.value3 =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y, <span class="dt">num.permutations =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb51-36" title="36"></a>
<a class="sourceLine" id="cb51-37" title="37">p &lt;-<span class="st"> </span><span class="kw">c</span>(p.value1,p.value2,p.value3<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb51-38" title="38"><span class="kw">names</span>(p) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;energy test&#39;</span>,<span class="st">&#39;ball test&#39;</span>)</a>
<a class="sourceLine" id="cb51-39" title="39">sim[i<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(epsilon,p)</a>
<a class="sourceLine" id="cb51-40" title="40">}</a>
<a class="sourceLine" id="cb51-41" title="41"> </a>
<a class="sourceLine" id="cb51-42" title="42"><span class="kw">plot</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">2</span>], <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb51-43" title="43"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylab =</span> <span class="st">&quot;p-value&quot;</span>)</a>
<a class="sourceLine" id="cb51-44" title="44"><span class="kw">lines</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb51-45" title="45"><span class="kw">lines</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">4</span>], <span class="dt">lty =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb51-46" title="46"><span class="kw">abline</span>(<span class="dt">h =</span> alpha, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb51-47" title="47"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dv">1</span>, <span class="kw">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;energy test&#39;</span>,<span class="st">&#39;ball test&#39;</span>),</a>
<a class="sourceLine" id="cb51-48" title="48"><span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="dt">inset =</span> <span class="fl">.02</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The energy test performs better if the expectation changes along with variance.</p>
<ol start="3" style="list-style-type: decimal">
<li>We can generate random X and Y from these two distribution below like: <span class="math inline">\(X\sim t(1)\)</span>, <span class="math inline">\(F_Y(y) = \alpha F_{X_1}(x)+(1-\alpha)F_{X_2}(x)\)</span> assuming <span class="math inline">\(X_1,X_2\)</span> have diffirent distributions.</li>
</ol>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">sim &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">41</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb52-2" title="2"></a>
<a class="sourceLine" id="cb52-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">40</span>) {</a>
<a class="sourceLine" id="cb52-4" title="4">  epsilon &lt;-<span class="st"> </span>i<span class="op">*</span>.<span class="dv">025</span></a>
<a class="sourceLine" id="cb52-5" title="5">X &lt;-<span class="st"> </span><span class="kw">rt</span>(<span class="dv">40</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb52-6" title="6">x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">40</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb52-7" title="7">x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">40</span>,<span class="dv">4</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-8" title="8">u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">40</span>)</a>
<a class="sourceLine" id="cb52-9" title="9">k &lt;-<span class="st"> </span><span class="kw">as.integer</span>(u<span class="op">&gt;</span>epsilon)</a>
<a class="sourceLine" id="cb52-10" title="10">Y &lt;-<span class="st"> </span>k<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>k)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb52-11" title="11"></a>
<a class="sourceLine" id="cb52-12" title="12"><span class="co">#NN test</span></a>
<a class="sourceLine" id="cb52-13" title="13">Z &lt;-<span class="st"> </span><span class="kw">c</span>(X, Y)</a>
<a class="sourceLine" id="cb52-14" title="14">Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</a>
<a class="sourceLine" id="cb52-15" title="15">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb52-16" title="16">  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb52-17" title="17">  z &lt;-<span class="st"> </span>z[ix, ];</a>
<a class="sourceLine" id="cb52-18" title="18">  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></a>
<a class="sourceLine" id="cb52-19" title="19">  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb52-20" title="20">  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb52-21" title="21">  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</a>
<a class="sourceLine" id="cb52-22" title="22">  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb52-23" title="23">}</a>
<a class="sourceLine" id="cb52-24" title="24"><span class="kw">set.seed</span>(<span class="dv">12345</span>); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(X), <span class="kw">length</span>(Y))</a>
<a class="sourceLine" id="cb52-25" title="25">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb52-26" title="26">                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N,<span class="dt">k=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb52-27" title="27">ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb52-28" title="28">p.value1 &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb52-29" title="29"></a>
<a class="sourceLine" id="cb52-30" title="30"><span class="co">#energy test</span></a>
<a class="sourceLine" id="cb52-31" title="31">boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(Z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb52-32" title="32">p.value2 &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb52-33" title="33"></a>
<a class="sourceLine" id="cb52-34" title="34"><span class="co">#ball test</span></a>
<a class="sourceLine" id="cb52-35" title="35">p.value3 =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y, <span class="dt">num.permutations =</span> <span class="dv">999</span>) </a>
<a class="sourceLine" id="cb52-36" title="36"></a>
<a class="sourceLine" id="cb52-37" title="37">p &lt;-<span class="st"> </span><span class="kw">c</span>(p.value1,p.value2,p.value3<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb52-38" title="38"><span class="kw">names</span>(p) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;energy test&#39;</span>,<span class="st">&#39;ball test&#39;</span>)</a>
<a class="sourceLine" id="cb52-39" title="39">sim[i<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(epsilon,p)</a>
<a class="sourceLine" id="cb52-40" title="40">}</a>
<a class="sourceLine" id="cb52-41" title="41"> </a>
<a class="sourceLine" id="cb52-42" title="42"><span class="kw">plot</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">2</span>], <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb52-43" title="43"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylab =</span> <span class="st">&quot;p-value&quot;</span>)</a>
<a class="sourceLine" id="cb52-44" title="44"><span class="kw">lines</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-45" title="45"><span class="kw">lines</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">4</span>], <span class="dt">lty =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb52-46" title="46"><span class="kw">abline</span>(<span class="dt">h =</span> alpha, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb52-47" title="47"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dv">1</span>, <span class="kw">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;energy test&#39;</span>,<span class="st">&#39;ball test&#39;</span>),</a>
<a class="sourceLine" id="cb52-48" title="48"><span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="dt">inset =</span> <span class="fl">.02</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It seems energy test performs the best and ball test is also good enough. However the NN test can detect the difference between the t-distribution and bimodel distribution only when the bi-leak patterns is really clear.</p>
<ol start="4" style="list-style-type: decimal">
<li>We can generate random X and Y from these two distribution below like: <span class="math inline">\(X\sim N(\mu_1,\Sigma_1)\)</span>, <span class="math inline">\(Y\sim N(\mu_2,\Sigma_2)\)</span> assuming they have Unbalanced samples.</li>
</ol>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">sim &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">21</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb53-2" title="2"></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">20</span>) {</a>
<a class="sourceLine" id="cb53-4" title="4">  epsilon &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb53-5" title="5">  mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb53-6" title="6">sigma1 &lt;-<span class="st"> </span><span class="dv">4</span><span class="op">*</span><span class="kw">diag</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb53-7" title="7">mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb53-8" title="8">sigma2 &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb53-9" title="9">X &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(epsilon,mu1,sigma1)</a>
<a class="sourceLine" id="cb53-10" title="10">Y &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(epsilon<span class="op">*</span><span class="dv">10</span>,mu2,sigma2)</a>
<a class="sourceLine" id="cb53-11" title="11"></a>
<a class="sourceLine" id="cb53-12" title="12"><span class="co">#NN test</span></a>
<a class="sourceLine" id="cb53-13" title="13">Z &lt;-<span class="st"> </span><span class="kw">rbind</span>(X, Y)</a>
<a class="sourceLine" id="cb53-14" title="14">Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</a>
<a class="sourceLine" id="cb53-15" title="15">  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb53-16" title="16">  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb53-17" title="17">  z &lt;-<span class="st"> </span>z[ix, ];</a>
<a class="sourceLine" id="cb53-18" title="18">  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></a>
<a class="sourceLine" id="cb53-19" title="19">  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb53-20" title="20">  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb53-21" title="21">  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</a>
<a class="sourceLine" id="cb53-22" title="22">  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb53-23" title="23">}</a>
<a class="sourceLine" id="cb53-24" title="24"><span class="kw">set.seed</span>(<span class="dv">12345</span>); N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">nrow</span>(X), <span class="kw">nrow</span>(Y))</a>
<a class="sourceLine" id="cb53-25" title="25">boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> Z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb53-26" title="26">                 <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N,<span class="dt">k=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb53-27" title="27">ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb53-28" title="28">p.value1 &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb53-29" title="29"></a>
<a class="sourceLine" id="cb53-30" title="30"><span class="co">#energy test</span></a>
<a class="sourceLine" id="cb53-31" title="31">boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(Z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</a>
<a class="sourceLine" id="cb53-32" title="32">p.value2 &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb53-33" title="33"></a>
<a class="sourceLine" id="cb53-34" title="34"><span class="co">#ball test</span></a>
<a class="sourceLine" id="cb53-35" title="35">p.value3 =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y, <span class="dt">num.permutations =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb53-36" title="36"></a>
<a class="sourceLine" id="cb53-37" title="37">p &lt;-<span class="st"> </span><span class="kw">c</span>(p.value1,p.value2,p.value3<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb53-38" title="38"><span class="kw">names</span>(p) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;energy test&#39;</span>,<span class="st">&#39;ball test&#39;</span>)</a>
<a class="sourceLine" id="cb53-39" title="39">sim[i<span class="op">+</span><span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">c</span>(epsilon,p)</a>
<a class="sourceLine" id="cb53-40" title="40">}</a>
<a class="sourceLine" id="cb53-41" title="41"> </a>
<a class="sourceLine" id="cb53-42" title="42"><span class="kw">plot</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">2</span>], <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb53-43" title="43"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylab =</span> <span class="st">&quot;p-value&quot;</span>)</a>
<a class="sourceLine" id="cb53-44" title="44"><span class="kw">lines</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb53-45" title="45"><span class="kw">lines</span>(sim[,<span class="dv">1</span>], sim[,<span class="dv">4</span>], <span class="dt">lty =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb53-46" title="46"><span class="kw">abline</span>(<span class="dt">h =</span> alpha, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb53-47" title="47"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dv">1</span>, <span class="kw">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;energy test&#39;</span>,<span class="st">&#39;ball test&#39;</span>),</a>
<a class="sourceLine" id="cb53-48" title="48"><span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="dt">inset =</span> <span class="fl">.02</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OpA6kNtmAABmADpmkJBmtrZmtv+QOgCQkGaQ27aQ2/+2ZgC2tma225C2///bkDrb////tmb/25D//7b//9v///8FGheYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMHElEQVR4nO2dC3ejOBaEqzOdzM6s3bPJbDzbbsfh///KRQ8wT70AV9nxd05sLC5X5WohgaAxqgdBwBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqYOV0NwPLoHXTbQdWD1yYjt1g+igatG49y8DVDer+22xZz0rg0YLC4GFQGKgZhIdB4XR4GBRNt3I9y4CaQXgYFE6Hh0HBdFlHrtcAD4PCQM4gfBWDDsDz51v9hV+z0n0Zg47ff9UePVfVeb/LSPdldrHPt9qW07f3ylmVnA7Vkhb0+fb007wfvv/qLNpVp6mGPFk4FLSNQed9XffJanSviemWGmTarDeoXWz1TIqMgDtrQb/9bqq0BrWLZo2cQZc+yFqVnG6pQc9H026sQe1i/frxAtQLx3rM2PmPePWFYSA2ii02yLYKZ1CzaNbY5WPdoj9edvWf2f/xSm1BhenGBsVmjLvUrrimaw1qFs0a44UbT+susekVb9AgLG5Bdpf2BvlFs8Z44brEuvmc984hEYOOGaPYCgaZJuIN8otmjTXIt7rXyu/6IgYNs4Qm7Y1BkyvSsK5Uh11jkFs0ay4tqOHw7V3ToHC6NQz6+P2PxiC7aNa4PqjrR/3pRg1auouZAbQxyC6ad9tBm1HMtBzblE6mBc0cgfRVJutJDvRi3Y400wPN9EHVGgad961BZtGuOjTHQUaP6Y2sWcTjoCP8v84JGQeKpmzBLrYB2PJUw5FzqmHK7sKg875unIfAHtzp/3JOVk3ZPRhUd3B1uwj1cV+7BZlvb7723CGg4dicg33FPsjsP8aguZ3HB7lRbHacmKrXlN2BQU0LOkQHyaR0g7I7MMj3QcfZmYzMdP2yKxsUmYtF8SjmDrUWMFWvKbuuQbGpRmidapiyh0Hz6aw3iwzyk6rn/X/2bi6zKfjxtznJONTt/u9v7wdzGmJnZKNzsSgbxRA5z8pKNyhaYlAzqXre1wtH/+cKzDc+1IJPdddght/PN9tKYnOxWNCCgqN8frq2qL+imTqae+/STqraBTt3OCio2omgD3vRIzoXiyW7mG2pxUzUi7kViXQmVV/t1+wX+Ot0ddnhuTnAj83FYolBy5rQRL2YW5FIO6naGtQrOLYGmblYd4Afm4vFEoNCpxoF6dZqQZVvAm0LagouLej8478/3tsVoblYLDDovFfbxdov1hjUL3B9kOmRP9/+9MNUbC4WS0axojON0KQ9+vXk00yqNgb1C9pRrDOfF5uLhdZx0OJ6/KRqa1CvwF7uffrH7Gh+DKuic7G4M4MSsD3Rx78TWz++kkG2D3K7zzF+PaNqxCTrcYHtYfT6R9K+W0oWlM3JDea1U8ndJ5Ra0OYGFQApgzapZxkoMqjZzdbexeZWEEGRQYfvv47P/rhrSdXTJcmCrgHKDhR31ckcPaw8J425FURQZtBr9fGvn/YvQqCVjevF3IpUxrV1zhvKbgRGiUHmqsa5PtkLGJRwMDCuF3MrUgkZVHifK4r6IHMaf9gFdzF/vVCnBV3VIDPhVLeR4CDmJjmvbdBfL25y2Zx1oXtGX3ojMDY8DjrYmd6lBpmjR3/yP7HYT/Dx4ieX7WSnOUcftKD8G4Gx5YHiEbscg5qvm11Pi/XGdACmh7Qu9A0quBEYZaNY4kzZx8tvVzbI1OYnCE9+8rRjUMGNwCg7UEy9rvr5Nn95GoOk7WKyoBFulse81n3N0/9GLajgRmCU7mK2rhWmXDEsWKUF2YXxLlZwIzAW9EHNf8mKkHwjOeZWJOP7oO+/Tm56cNwHZd8IjKu3oPk5aQze87GjmPHFNR7segYV3QiMsiPp5fd2TAzqqIYlubjjIH9J/tu724eaVlJ2IzA2HcVS0mFYcAcnq4bZ/yd3CYjMGWGYFdWwRABsZVD6jeToFeQIugbYyKCM24DRK8gRdA2wkUEFN5K7YS1H0DUAvwW1nzGzggq2OllNv5EcswUKoMwgO2EYPoJIv5Ec0581QJFB/okBy44Vh/XCveAODPL3P658pz3cyz0YdPZ3Z610Cx4ub6juwqCmBa10XQyXN/unRVkf5E8I17myOjSov+5S67KmNayuYMvkwHXugMFgCVPraoOGcUury86SvEF25tR0GKXH5R3d8jWqy86XvEF25rx0mFjGetViYil3y7UCi9JdukPMGbRIQHma5PjcxOnp4F9Q9RaGw/4iAZhYyt1yrcDsdHAvaD9dlr6eQd0jjEF2tIvolqEbU1zt5GLupisFFqVDzyB0y9CJSUsWDIjG5uYuTZyeDqPsaF7Hq2LJkmrLITk+N3F6OoyyoxuRUnEsBjPLK6QuzZuRDqPs6BajVxrNFl0fi81MXZo3Jx16o1Wz3PRFbX8+p2CufBTSfU0mOTwzb046TBmE1prxmDefKhiBxPDM7LmBRem6FlwMyqg5GISqkzApXWLiosCidL02Yj90CjB4T8g3sRI3bBCmDMIodlLCZOFcDBI3yMyfF2jJe8gbBtkx3OcCX22qcFg2yp5BcnRW2tyHvA16Ydieuf95RgJGCxN+9wum0syTHJ2TNvnKKnqfLiuH+1zV7bSnZaFb1Ivs+TOTZp7k6Jy06dfmm7d+9hmDwrLQXUA3otunQcKg9Bbk96SRQf0CpAhA770b3R5PVaNVcZKjs9ImXJtH8wf/1yvD4PNg/eQfEmKK4tJIDrRkPOQNgz7UlU1GjzTAB1/iJxaGuUZZpgXO1Tm7QWpgQbqR5nhBm+XStwzSwm032BCjMW46cRuTEJwZuEa6ibUT7ayJhN8HMeh6Jn1FShPC5GLyNjnkPJE8shYj+icllx4fvnzSilGjmohIFloSGKm7/XKFWzcGTKS5pG669piIOToDabLQ5EBKuu3A6oGUdNuB1QMtRU8klwSrBxrKnkguCVYPrNJONW6GLQxKOFldpTJK2BqbJ7SgVSqjhK2yefxkdZXKKGHrbL7oUXlfwaCFJFZGCdto800qo4RttPkmlVHCNtp8k8ooYRttvklllLCNNr9/wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAfXqsjN1sYeA+afRXyKPE7NhYVT2oucu5RsQVC6YS6XXwUJ4B+maX/KKPCdfFgw5eeb+SUyY18sWxgUbpdNypW0k7uo7S4vzf+Olw8Lp/S/+fP0M5YtAgq3y+YYV3jCzv3CSvPdwmFJKf0DPMt/9Aplm+Vz+LPpEkKcLr/RE2ofbl1CysPTz3i2ICjbLBv/e4Qxh9zjSG2HEeo2bFhCSnOBM54tCMo2KyT675hjUDzlqemjb8ag6K92ZO1isZTuAvmN7GKO6Fif0klXfYNmUx67P1Eg30n7p0In7WLxgbnj42zK5k6LWxnmrcK0Tjp+aOdHsVBK9xjqKiVbEBRul4//zYcwvj0cIycHPiyU8ujuQ3G/fXgLpxq3CtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2gBjmN9IX/eziQsCrOglzC2L01s8tAa/qJJof76QBbvVxPt8W3D+3AiDWnULnwXIcwK0+yrLfxV0BcKuPYjro8770JucVAK/qND5eHsO8NGALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALU+T8I7g4WeWh1HQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>It seems in the unbalanced sample size situation, with the sample size increasing (pro ratas), the energy test is the most robust and the ball test the second robust.</p>
<p>#Homework 8 ## Question 9.4 Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<p>The density function of Laplace distribution is: <span class="math display">\[f(x)=\frac{1}{2}e^{-|x|} \quad,x\in\mathbb R\]</span> and the distributon function is: <span class="math display">\[F(x)=\begin{cases}
\frac{1}{2}e^x,\quad x&lt;0\\
1-\frac{1}{2}e^{-x},\quad x\geqslant 0
\end{cases}\]</span></p>
<p>So,the 97.5% and 2.5% quantile of Laplace distribution are close to +3 and -3 respectively, according to which we can give the reference line.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb54-2" title="2"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb54-3" title="3">dLaplace &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb54-4" title="4">  y &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb54-5" title="5">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb54-6" title="6">}</a>
<a class="sourceLine" id="cb54-7" title="7"></a>
<a class="sourceLine" id="cb54-8" title="8">rw.Metropolis.L &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb54-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb54-10" title="10">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb54-11" title="11">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb54-12" title="12">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb54-13" title="13">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb54-14" title="14">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb54-15" title="15">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dLaplace</span>(y)<span class="op">/</span><span class="kw">dLaplace</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb54-16" title="16">      x[i] &lt;-<span class="st"> </span>y  </a>
<a class="sourceLine" id="cb54-17" title="17">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb54-18" title="18">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb54-19" title="19">      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb54-20" title="20">    }</a>
<a class="sourceLine" id="cb54-21" title="21">  }</a>
<a class="sourceLine" id="cb54-22" title="22">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb54-23" title="23">}</a>
<a class="sourceLine" id="cb54-24" title="24"></a>
<a class="sourceLine" id="cb54-25" title="25">n &lt;-<span class="st"> </span><span class="dv">4</span>  <span class="co">#degrees of freedom for target Student t dist.</span></a>
<a class="sourceLine" id="cb54-26" title="26">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb54-27" title="27">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>,  <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb54-28" title="28"></a>
<a class="sourceLine" id="cb54-29" title="29">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb54-30" title="30">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis.L</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb54-31" title="31">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis.L</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb54-32" title="32">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis.L</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb54-33" title="33">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis.L</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb54-34" title="34">reject &lt;-<span class="st"> </span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb54-35" title="35">no.reject &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb54-36" title="36"><span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb54-37" title="37">no.reject &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">no.reject=</span>reject,<span class="dt">accepted.rate=</span>(N<span class="op">-</span>reject)<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb54-38" title="38">knitr<span class="op">::</span><span class="kw">kable</span>(no.reject)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
no.reject
</th>
<th style="text-align:right;">
accepted.rate
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
0.9825
</td>
</tr>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
340
</td>
<td style="text-align:right;">
0.8300
</td>
</tr>
<tr>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
958
</td>
<td style="text-align:right;">
0.5210
</td>
</tr>
<tr>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
1783
</td>
<td style="text-align:right;">
0.1085
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co">#par(mfrow=c(2,2))  #display 4 graphs together</span></a>
<a class="sourceLine" id="cb55-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.025</span></a>
<a class="sourceLine" id="cb55-3" title="3">refline &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>alpha),<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(alpha))</a>
<a class="sourceLine" id="cb55-4" title="4">rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb55-5" title="5"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb55-6" title="6">  <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb55-7" title="7">       <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb55-8" title="8">       <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb55-9" title="9">  <span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb55-10" title="10">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAV1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZrY6kNtmAABmADpmZjpmZrZmtv+QOgCQ2/+2ZgC2Zma2/7a2///bkDrb////tmb/25D//7b//9v////iS8F+AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHjklEQVR4nO2d4WKbNhhFlTZpt3hbGm91bZf3f85hBEKAxAUjMIZzfiR2EBc4+SSwIxOTQS/m0TuwdhAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECcYIuh7e869nY8yXn3Ptz+oYLej09dft0cdse7Qyxgoq1RSadsFYQZe3QtB5N50scQWZp2EeQbfk16warifGPZRZBGWFo5fP/EQW8YOghePmY2FBra49vIc/jJkEnXIFdpCOnMXMPamPYB5Bp3z8uR5uozSCQvz+8V58zU/xCApRvcA4fv2FoBC2gnKOrwgKUmnJr4YQFORkz2F5LSFo0nYRJOIQJOIQJOIQJOIQJOIQJOIQJOIQJOIQ1E5pvReOIBGHIBGHIBGHIBGHIBGHIBGHIBGHIBG3U0EDZpghSMwwQ5CaHzQ+9THMJkjMMEMQFdTD8BlmOxWUDZ5htl9BA+MQ1E7hDbNxcQgScTsVZM9iFq6DQkRnvbTj9iooN/Q6KG63gvIroP7PQe1e0MA4BIk4BIk4BIk4BIk4BIm4TQv6d8qnUbcq6PpP9fzyNunjupsVdHj5LB4cJ94zYKuC8tcQt7dSL29GvJSIpezg/aCzefnblHU0ebtbFFQWUZrtblHQ6VZBk++nsFlB18OtfPKvsT9XjIvbnCDOYqIh10EjGnIlfV/DUXEIEnEIEnEIEnEIEnEIEnE7FcQsVwGzXAXMURTEZ7nu4Q2zAVBBgqee5dq68dxcp/kJs1zN8JvjzeE337gf++jroEBsUkHjd3srgoyXorcz4Idu4UoEPQ2PElR5Ci0qdkvs2rAKCob0J6+lgoJ7Uy5aRlBkA1XVVK3UJho7lA4nqLubbUGR4+jZqfrHjXRjGt/9Zf7DSlDf1ns3moREgrwCNF6q++lOBIVU9QoymxVkikOOCDJhQd6R+IKMu2CobRn/uz/I+BmrE+Tvrz3gUpA7gqCgUmJLUPG0Cq2T6lUyLajzozFHlIqWIFMdiy8oawoyVaP6p05QlWCcoMwJMr6YskbsU++xt4HVCsrCghqiGoKMM+KeZZ6gSqi7Mq+KtV2yWUeQs7S4oPYFalSQ95v0upo3ZNXLXN/yBdml5cqeGK8MewT5/XrwoU0SE4szHvURVgNHNWb6g4XXg1ypdARlLUFu+M3cwFRGNUz7gsyaBHk9pymoUW7uSLwaaXS1qj/5ndMvOFdHrmqdiuaA1TgZjDyiVLgdryq6XlALyrzhxClp7b03QtXH35CZucdex/Zqy+tUftcee9xzCcq6gvwayZon99aOeO2CgrzW5bhfPjaueNudan2CWtGtChogyK3nDTHDBHlbrCOfQVBjlGxvudPF3HpVH/TVGn+1IYICmxh3RIm4X1Arxf/dN783s+OC2gPbugQFFowT5D1pr9AvqNWtYrFPIGhSdlhQu9kaBT0NcwgaPrsjtGDyryJaAEOvjmevoOGzO0ILktbqegUN+9t8aMGMgu5YaTZBw+5hFlqwE0F3V9D9Zy+5nRUJug3/q/gvmUlH/JRbiszuGH/2nMhqBS0cN9925hTk/g9bmri7QJAAQXODIAGCBFs/i02GtzsUDxI0LnRgu4c0u7N52lAEpWmHoDU2u7N52lAEpWmHoDU2u7N52lAEpWm3PUFbAkECBAkQJECQAEECBAkQJECQAEECBAkQJECQIL2gs+m7LXU9x8i161+hj8v3n6kjOyQXdL7NH4rv3eXbZ6udWKGH66GYCJgysktqQfbv0sforburyY2unVohzrmcjpwwMkBqQXaS5yk6kfr02mqnVohyNu9WTbrIEMkFFfUemwSb/17/yMeLd6+dWqEPu1bSyA6pBdmuHx0Arofb9Njje91OrNC/sZuDtJEdFhZUNvryM52gtJEdlu5ittHbR8IuljSyw9KDtG307TPJiOoLShTZYeHTvN33/MCSnJMLQWkjOyx9oVjsdj6iJrmqK89iKSM7pH+pceq/zD/m5+SPRjuxQg9lF0sZ2YEXqwIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkQJAAQQIECRAkeCZBdtZvdnmzk36X4YkElbN+z19/5Q8XM/Q8gspZv3byT6LZUQN4GkHVrF83bXwh1iboaO8PFbxLWiHo/OW/Q2T5LKxM0DEfYC5/RhYWgk63jvb7x07HoHJ+qj36spjqM5YV9JJwCusA1iXIHvf1r/AwYwXZD7C8RW6JnpxVCorcEL4cgxqf8JmddQmyasryCHcx22SvXSw/mX/kI3Dkduflh3vypX03A03MygQVryMifqqyOccuA2ZhbYJWB4IECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSIAgAYIECBIgSPA/AyJPdTpwxTIAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co">#par(mfrow=c(1,1)) #reset to default</span></a></code></pre></div>
<hr />
</div>
<div id="question-9.4supplemented" class="section level2">
<h2>Question 9.4(supplemented)</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat R\)</span> &lt; 1.2.</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<p>We take <span class="math inline">\(\sigma=2\)</span> for example.The value of <span class="math inline">\(\hat R\)</span> is below 1.2 within 1000 iterations and below 1.1 within 2000 iterations</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</a>
<a class="sourceLine" id="cb57-2" title="2">  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></a>
<a class="sourceLine" id="cb57-3" title="3">  <span class="co"># for chain in i-th row of X</span></a>
<a class="sourceLine" id="cb57-4" title="4">  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</a>
<a class="sourceLine" id="cb57-5" title="5">  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</a>
<a class="sourceLine" id="cb57-6" title="6">  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</a>
<a class="sourceLine" id="cb57-7" title="7">  </a>
<a class="sourceLine" id="cb57-8" title="8">  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)     <span class="co">#row means</span></a>
<a class="sourceLine" id="cb57-9" title="9">  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means)        <span class="co">#between variance est.</span></a>
<a class="sourceLine" id="cb57-10" title="10">  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></a>
<a class="sourceLine" id="cb57-11" title="11">  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)               <span class="co">#within est.</span></a>
<a class="sourceLine" id="cb57-12" title="12">  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)     <span class="co">#upper variance est.</span></a>
<a class="sourceLine" id="cb57-13" title="13">  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W             <span class="co">#G-R statistic</span></a>
<a class="sourceLine" id="cb57-14" title="14">  <span class="kw">return</span>(r.hat)</a>
<a class="sourceLine" id="cb57-15" title="15">}</a>
<a class="sourceLine" id="cb57-16" title="16"></a>
<a class="sourceLine" id="cb57-17" title="17">sigma &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb57-18" title="18">k &lt;-<span class="st"> </span><span class="dv">4</span>          <span class="co">#number of chains to generate</span></a>
<a class="sourceLine" id="cb57-19" title="19">n &lt;-<span class="st"> </span><span class="dv">15000</span>      <span class="co">#length of chains</span></a>
<a class="sourceLine" id="cb57-20" title="20"></a>
<a class="sourceLine" id="cb57-21" title="21"><span class="co">#choose overdispersed initial values</span></a>
<a class="sourceLine" id="cb57-22" title="22">x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb57-23" title="23"></a>
<a class="sourceLine" id="cb57-24" title="24"><span class="co">#generate the chains</span></a>
<a class="sourceLine" id="cb57-25" title="25"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb57-26" title="26">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</a>
<a class="sourceLine" id="cb57-27" title="27"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb57-28" title="28">  dd &lt;-<span class="st"> </span><span class="kw">rw.Metropolis.L</span>(<span class="dt">sigma=</span>sigma, <span class="dt">N=</span>n, <span class="dt">x0=</span>x0[i])</a>
<a class="sourceLine" id="cb57-29" title="29">  dd3 &lt;-<span class="st"> </span>dd<span class="op">$</span>x</a>
<a class="sourceLine" id="cb57-30" title="30">  X[i, ] &lt;-<span class="st"> </span>dd3</a>
<a class="sourceLine" id="cb57-31" title="31">}</a>
<a class="sourceLine" id="cb57-32" title="32"></a>
<a class="sourceLine" id="cb57-33" title="33"><span class="co">#compute diagnostic statistics</span></a>
<a class="sourceLine" id="cb57-34" title="34">psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</a>
<a class="sourceLine" id="cb57-35" title="35"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</a>
<a class="sourceLine" id="cb57-36" title="36"></a>
<a class="sourceLine" id="cb57-37" title="37"><span class="co">#plot the sequence of R-hat statistics</span></a>
<a class="sourceLine" id="cb57-38" title="38">rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</a>
<a class="sourceLine" id="cb57-39" title="39"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb57-40" title="40">  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</a>
<a class="sourceLine" id="cb57-41" title="41"><span class="kw">plot</span>(rhat[<span class="dv">2</span><span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.3</span>),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">8000</span>))</a>
<a class="sourceLine" id="cb57-42" title="42"><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> ***</p>
</div>
<div id="question-11.4" class="section level2">
<h2>Question 11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt k )\)</span> <span class="math display">\[S_{k-1}(a)=P\left( t(k-1)&gt;\sqrt\frac{a^2(k-1)}{k-a^2} \right)\]</span> and <span class="math display">\[S_{k}(a)=P\left( t(k)&gt;\sqrt\frac{a^2k}{k+1-a^2} \right)\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">k1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb58-2" title="2">f &lt;-<span class="st"> </span><span class="cf">function</span>(a,<span class="dt">k=</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb58-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-4" title="4">  y &lt;-<span class="st"> </span><span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-5" title="5">  Sk1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(x,<span class="dt">df=</span>k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb58-6" title="6">  Sk2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(y,<span class="dt">df=</span>k)</a>
<a class="sourceLine" id="cb58-7" title="7">  Sk1<span class="op">-</span>Sk2</a>
<a class="sourceLine" id="cb58-8" title="8">}   </a>
<a class="sourceLine" id="cb58-9" title="9">res &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb58-10" title="10">res</a></code></pre></div>
<pre><code>## $root
## [1] 1.492103
## 
## $f.root
## [1] -1.155906e-09
## 
## $iter
## [1] 5
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">aa &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">plot</span>(aa,<span class="kw">f</span>(aa,<span class="dt">k=</span><span class="dv">4</span>),<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb60-3" title="3"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>,<span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb60-4" title="4"><span class="kw">points</span>(<span class="fl">1.49</span>,<span class="dv">0</span>,<span class="dt">cex=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot,we find that the solution is approximately in the interval (1,2).</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">res &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb61-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k1)) {</a>
<a class="sourceLine" id="cb61-3" title="3">  f &lt;-<span class="st"> </span><span class="cf">function</span>(a,<span class="dt">k=</span>k1[i]){</a>
<a class="sourceLine" id="cb61-4" title="4">    x &lt;-<span class="st"> </span><span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb61-5" title="5">    y &lt;-<span class="st"> </span><span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb61-6" title="6">    Sk1 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(x,<span class="dt">df=</span>k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb61-7" title="7">    Sk2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(y,<span class="dt">df=</span>k)</a>
<a class="sourceLine" id="cb61-8" title="8">    Sk1<span class="op">-</span>Sk2</a>
<a class="sourceLine" id="cb61-9" title="9">  }  </a>
<a class="sourceLine" id="cb61-10" title="10">  sol &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))<span class="op">$</span>root,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb61-11" title="11">  res[i] &lt;-<span class="st"> </span>sol</a>
<a class="sourceLine" id="cb61-12" title="12">}</a>
<a class="sourceLine" id="cb61-13" title="13">sol &lt;-<span class="st"> </span><span class="kw">cbind</span>(k1,res)</a>
<a class="sourceLine" id="cb61-14" title="14"><span class="kw">print</span>(sol)</a></code></pre></div>
<pre><code>##         k1     res
##  [1,]    4 1.49210
##  [2,]    5 1.53356
##  [3,]    6 1.56274
##  [4,]    7 1.58443
##  [5,]    8 1.60118
##  [6,]    9 1.61452
##  [7,]   10 1.62539
##  [8,]   11 1.63442
##  [9,]   12 1.64204
## [10,]   13 1.64855
## [11,]   14 1.65419
## [12,]   15 1.65911
## [13,]   16 1.66345
## [14,]   17 1.66730
## [15,]   18 1.67075
## [16,]   19 1.67384
## [17,]   20 1.67664
## [18,]   21 1.67918
## [19,]   22 1.68150
## [20,]   23 1.68362
## [21,]   24 1.68557
## [22,]   25 1.68737
## [23,]  100 1.72061
## [24,]  500 1.72976
## [25,] 1000 1.73091</code></pre>
<p>#Homework 9 ## A-B-O blood type problem</p>
<table>
<tbody>
<tr>
<td style="text-align:left;">
Genotype
</td>
<td style="text-align:left;">
AA
</td>
<td style="text-align:left;">
BB
</td>
<td style="text-align:left;">
OO
</td>
<td style="text-align:left;">
AO
</td>
<td style="text-align:left;">
BO
</td>
<td style="text-align:left;">
AB
</td>
<td style="text-align:left;">
sum
</td>
</tr>
<tr>
<td style="text-align:left;">
Frequency
</td>
<td style="text-align:left;">
p^2
</td>
<td style="text-align:left;">
q^2
</td>
<td style="text-align:left;">
r^2
</td>
<td style="text-align:left;">
2pq
</td>
<td style="text-align:left;">
2pr
</td>
<td style="text-align:left;">
2qr
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Count
</td>
<td style="text-align:left;">
nAA
</td>
<td style="text-align:left;">
nBB
</td>
<td style="text-align:left;">
nOO
</td>
<td style="text-align:left;">
nAO
</td>
<td style="text-align:left;">
nBO
</td>
<td style="text-align:left;">
nAB
</td>
<td style="text-align:left;">
n
</td>
</tr>
</tbody>
</table>
<ul>
<li>Observed data: nA· = nAA + nAO = 444 (A-type), nB· = nBB + nBO = 132 (B-type), nOO = 361 (O-type), nAB = 63 (AB-type).</li>
<li>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</li>
<li>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</li>
</ul>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<p>The log likelihood function: <span class="math display">\[Q=log\mathcal L_c(p,q|x)=n_{AA}lnp^2+n_{BB}lnq^2+n_{OO}lnr^2+n_{AO}ln2pr+n_{BO}ln2qr+n_{AB}lnpq\\
r=1-p-q
\]</span> The distribution of <span class="math inline">\(n_{AA},n_{BB}\)</span> given <span class="math inline">\(n_{A\cdot},n_{B\cdot}\)</span></p>
<p><span class="math display">\[\begin{align}
n_{AA}|n_{A\cdot}\sim B(n_{A\cdot},\frac{p^2}{p^2+2pr})\\
n_{BB}|n_{B\cdot}\sim B(n_{B\cdot},\frac{q^2}{q^2+2qr})
\end{align}
\]</span> The partial derivative of log likelihood function Q: <span class="math display">\[\begin{align}
\frac{\partial Q}{\partial p}=\frac{2n_{AA}+n_{AO}+n_{AB}}{p}-\frac{2n_{OO}+n_{AO}+n_{BO}}{r}\\
\frac{\partial Q}{\partial q}=\frac{2n_{BB}+n_{BO}+n_{AB}}{q}-\frac{2n_{OO}+n_{AO}+n_{BO}}{r}
\end{align}
\]</span></p>
<p>Solve the equation with<span class="math inline">\(r=1-p-q\)</span> <span class="math display">\[\begin{align}
r=\frac{2n_{OO}+n_{BO}+n_{AO}}{2n}\\
p=\frac{2n_{AA}+n_{AO}+n_{AB}}{2n}\\
q=\frac{2n_{BB}+n_{BO}+n_{AB}}{2n}
\end{align}
\]</span></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">bloodtype&lt;-<span class="cf">function</span>(p,n.obs){</a>
<a class="sourceLine" id="cb63-2" title="2">  n&lt;-<span class="kw">sum</span>(n.obs)</a>
<a class="sourceLine" id="cb63-3" title="3">  nA&lt;-n.obs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb63-4" title="4">  nB&lt;-n.obs[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb63-5" title="5">  nAB&lt;-n.obs[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb63-6" title="6">  nOO&lt;-n.obs[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb63-7" title="7">  <span class="kw">cat</span>(p,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb63-8" title="8">  pAt&lt;-pBt&lt;-pOt&lt;-Q &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb63-9" title="9">  pAt[<span class="dv">1</span>]&lt;-p[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb63-10" title="10">  pBt[<span class="dv">1</span>]&lt;-p[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb63-11" title="11">  pOt[<span class="dv">1</span>]&lt;-<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb63-12" title="12">  Q[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb63-13" title="13">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">20</span>){</a>
<a class="sourceLine" id="cb63-14" title="14">  pA.old&lt;-pAt[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb63-15" title="15">  pB.old&lt;-pBt[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb63-16" title="16">  pO.old&lt;-pOt[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb63-17" title="17">  </a>
<a class="sourceLine" id="cb63-18" title="18">  nAA &lt;-<span class="st"> </span>nA <span class="op">*</span><span class="st"> </span>pA.old<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(pA.old<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pA.old<span class="op">*</span>pO.old)</a>
<a class="sourceLine" id="cb63-19" title="19">  nAO &lt;-<span class="st"> </span>nA <span class="op">*</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>pA.old<span class="op">*</span>pO.old<span class="op">/</span>(pA.old<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pA.old<span class="op">*</span>pO.old)</a>
<a class="sourceLine" id="cb63-20" title="20">  nBB &lt;-<span class="st"> </span>nB <span class="op">*</span><span class="st"> </span>pB.old<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(pB.old<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pB.old<span class="op">*</span>pO.old)</a>
<a class="sourceLine" id="cb63-21" title="21">  nBO &lt;-<span class="st"> </span>nB <span class="op">*</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>pB.old<span class="op">*</span>pO.old<span class="op">/</span>(pB.old<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pB.old<span class="op">*</span>pO.old)</a>
<a class="sourceLine" id="cb63-22" title="22">  </a>
<a class="sourceLine" id="cb63-23" title="23">  pAt[i]&lt;-(<span class="dv">2</span><span class="op">*</span>nAA<span class="op">+</span>nAO<span class="op">+</span>nAB)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb63-24" title="24">  pBt[i]&lt;-(<span class="dv">2</span><span class="op">*</span>nBB<span class="op">+</span>nBO<span class="op">+</span>nAB)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb63-25" title="25">  pOt[i]&lt;-(<span class="dv">2</span><span class="op">*</span>nOO<span class="op">+</span>nAO<span class="op">+</span>nBO)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb63-26" title="26">  Q[i] &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(pAt[i])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(pBt[i])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(pOt[i])<span class="op">+</span></a>
<a class="sourceLine" id="cb63-27" title="27"><span class="st">    </span>nAO<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>pAt[i]<span class="op">*</span>pOt[i])<span class="op">+</span>nBO<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>pBt[i]<span class="op">*</span>pOt[i])<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>pAt[i]<span class="op">*</span>pBt[i])</a>
<a class="sourceLine" id="cb63-28" title="28">  }</a>
<a class="sourceLine" id="cb63-29" title="29">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">pAt=</span>pAt,<span class="dt">pBt=</span>pBt,<span class="dt">pOt=</span>pOt,<span class="dt">Q=</span>Q))</a>
<a class="sourceLine" id="cb63-30" title="30">}</a>
<a class="sourceLine" id="cb63-31" title="31">n.obs&lt;-<span class="kw">c</span>(<span class="dv">444</span>,<span class="dv">132</span>,<span class="dv">63</span>,<span class="dv">361</span>) <span class="co"># observed data,n_A,n_B,n_AB,n_OO</span></a>
<a class="sourceLine" id="cb63-32" title="32">p&lt;-<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb63-33" title="33">a&lt;-<span class="kw">bloodtype</span>(p,n.obs)</a></code></pre></div>
<pre><code>## 0.3333333 0.3333333</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">print</span>(a)</a></code></pre></div>
<pre><code>## $pAt
##  [1] 0.3333333 0.3275000 0.3042185 0.2988902 0.2978702 0.2976825 0.2976483
##  [8] 0.2976420 0.2976409 0.2976407 0.2976407 0.2976407 0.2976407 0.2976407
## [15] 0.2976407 0.2976407 0.2976407 0.2976407 0.2976407 0.2976407
## 
## $pBt
##  [1] 0.3333333 0.1195000 0.1039357 0.1028274 0.1027229 0.1027090 0.1027067
##  [8] 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063
## [15] 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063 0.1027063
## 
## $pOt
##  [1] 0.3333333 0.5530000 0.5918457 0.5982824 0.5994069 0.5996085 0.5996450
##  [8] 0.5996516 0.5996528 0.5996530 0.5996531 0.5996531 0.5996531 0.5996531
## [15] 0.5996531 0.5996531 0.5996531 0.5996531 0.5996531 0.5996531
## 
## $Q
##  [1]     0.000 -1584.251 -1451.832 -1431.785 -1428.437 -1427.846 -1427.739
##  [8] -1427.720 -1427.716 -1427.716 -1427.716 -1427.716 -1427.716 -1427.716
## [15] -1427.716 -1427.716 -1427.716 -1427.716 -1427.716 -1427.716</code></pre>
<p>As the result Q shows,the corresponding log-maximum likelihood values are increasing.</p>
<hr />
</div>
<div id="exercises-3-page-204-advanced-r." class="section level2">
<h2>Exercises 3 (page 204, Advanced R).</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb67-2" title="2">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb67-3" title="3">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb67-4" title="4">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb67-5" title="5">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb67-6" title="6">)</a></code></pre></div>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">attach</span>(mtcars)</a></code></pre></div>
<pre><code>## The following object is masked from package:ggplot2:
## 
##     mpg</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">formulas =<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb70-2" title="2">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb70-3" title="3">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb70-4" title="4">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb70-5" title="5">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb70-6" title="6">)</a>
<a class="sourceLine" id="cb70-7" title="7"></a>
<a class="sourceLine" id="cb70-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {<span class="kw">print</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(formulas[[i]])))}</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8922 -2.2022 -0.9631  1.6272  7.2305 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
## disp        -0.041215   0.004712  -8.747 9.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.251 on 30 degrees of freedom
## Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 
## F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7383 -1.8216 -0.0751  1.0487  4.6105 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   10.7520     0.7994   13.45 3.06e-14 ***
## I(1/disp)   1557.6739   114.8935   13.56 2.49e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.295 on 30 degrees of freedom
## Multiple R-squared:  0.8597, Adjusted R-squared:  0.855 
## F-statistic: 183.8 on 1 and 30 DF,  p-value: 2.494e-14
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10
## 
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7085 -1.5121 -0.6191  1.5142  4.2314 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.0242     3.4520   5.511 6.13e-06 ***
## I(1/disp)   1142.5600   199.8427   5.717 3.47e-06 ***
## wt            -1.7976     0.7327  -2.453   0.0204 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.124 on 29 degrees of freedom
## Multiple R-squared:  0.8838, Adjusted R-squared:  0.8758 
## F-statistic: 110.3 on 2 and 29 DF,  p-value: 2.788e-14</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">return</span> (<span class="kw">summary</span>(<span class="kw">lm</span>(x))))</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8922 -2.2022 -0.9631  1.6272  7.2305 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
## disp        -0.041215   0.004712  -8.747 9.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.251 on 30 degrees of freedom
## Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 
## F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7383 -1.8216 -0.0751  1.0487  4.6105 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   10.7520     0.7994   13.45 3.06e-14 ***
## I(1/disp)   1557.6739   114.8935   13.56 2.49e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.295 on 30 degrees of freedom
## Multiple R-squared:  0.8597, Adjusted R-squared:  0.855 
## F-statistic: 183.8 on 1 and 30 DF,  p-value: 2.494e-14
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7085 -1.5121 -0.6191  1.5142  4.2314 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.0242     3.4520   5.511 6.13e-06 ***
## I(1/disp)   1142.5600   199.8427   5.717 3.47e-06 ***
## wt            -1.7976     0.7327  -2.453   0.0204 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.124 on 29 degrees of freedom
## Multiple R-squared:  0.8838, Adjusted R-squared:  0.8758 
## F-statistic: 110.3 on 2 and 29 DF,  p-value: 2.788e-14</code></pre>
<hr />
</div>
<div id="excecises-3-and-6-page-213-214-advanced-r." class="section level2">
<h2>Excecises 3 and 6 (page 213-214, Advanced R).</h2>
<div id="note-the-anonymous-function-is-defined-in-section-10.2-page-181-advanced-r" class="section level3">
<h3>Note: the anonymous function is defined in Section 10.2 (page 181, Advanced R)</h3>
<ol start="3" style="list-style-type: decimal">
<li>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</li>
</ol>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb74-2" title="2"><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb74-3" title="3"><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb74-4" title="4"><span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb74-5" title="5">)</a></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="cf">function</span>(x) <span class="kw">return</span> (<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>))<span class="op">$</span>p.value))</a></code></pre></div>
<pre><code>##   [1] 0.178809502 0.994262402 0.064786264 0.952716251 0.306702525 0.198224877
##   [7] 0.272315768 0.283722503 0.415010770 0.151957272 0.072625558 0.249014108
##  [13] 0.773938569 0.225693023 0.840328179 0.987492066 0.316112244 0.481740992
##  [19] 0.457889571 0.565871989 0.990401857 0.257905112 0.538178810 0.764364559
##  [25] 0.845551784 0.905726387 0.086725138 0.763639767 0.088857796 0.531422351
##  [31] 0.731524606 0.195574176 0.598923896 0.702134266 0.147168770 0.552598436
##  [37] 0.117002585 0.233188724 0.127240002 0.115791872 0.317030411 0.691674119
##  [43] 0.450514119 0.315343567 0.073583503 1.000000000 0.011099981 0.580714657
##  [49] 0.591841839 0.638287091 0.283349660 0.722557025 0.408819857 0.127117578
##  [55] 0.000507563 0.841418067 0.624022112 0.650656602 0.632088219 0.578419158
##  [61] 0.052008307 0.920025002 0.646534041 0.344836350 0.751638828 0.687324041
##  [67] 0.134492519 0.490444844 0.711864108 0.020394691 0.342792908 0.960823950
##  [73] 0.111337525 0.546907007 0.773231299 0.626303636 0.298304108 0.146218612
##  [79] 0.133931753 0.814393484 0.096839576 0.974929586 0.808056754 0.346709412
##  [85] 0.308443909 0.600935588 0.984471134 0.703069949 0.678262994 0.565803030
##  [91] 0.895621651 0.723438333 0.431024548 0.061331285 0.043636182 0.359298038
##  [97] 0.372409666 0.953012247 0.503028465 0.594358009</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</li>
</ol>
</div>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">Mapvapplay&lt;-<span class="cf">function</span> (f,n,type, ...) {  </a>
<a class="sourceLine" id="cb77-2" title="2"> <span class="co">#n:the length of output  </span></a>
<a class="sourceLine" id="cb77-3" title="3"> f &lt;-<span class="st"> </span><span class="kw">match.fun</span>(f) </a>
<a class="sourceLine" id="cb77-4" title="4"> fM=<span class="kw">Map</span>(f, ...) </a>
<a class="sourceLine" id="cb77-5" title="5"> <span class="cf">if</span>(type<span class="op">==</span><span class="st">&quot;numeric&quot;</span>) <span class="kw">return</span>(<span class="kw">vapply</span>(fM,cbind,<span class="kw">numeric</span>(n))) </a>
<a class="sourceLine" id="cb77-6" title="6"> <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;character&quot;</span>) <span class="kw">return</span>(<span class="kw">vapply</span>(fM,cbind,<span class="kw">character</span>(n))) </a>
<a class="sourceLine" id="cb77-7" title="7"> <span class="cf">else</span> <span class="cf">if</span> (type<span class="op">==</span><span class="st">&quot;logical&quot;</span>) <span class="kw">return</span>(<span class="kw">vapply</span>(fM,cbind,<span class="kw">logical</span>(n))) </a>
<a class="sourceLine" id="cb77-8" title="8"> } </a></code></pre></div>
<p>#Homework 10 ## Question 1. Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<ol start="2" style="list-style-type: decimal">
<li><p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p></li>
<li><p>Campare the computation time of the two functions with the function “microbenchmark”.</p></li>
<li><p>Comments your results.</p></li>
</ol>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">library</span>(Rcpp)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">sourceCpp</span>(<span class="st">&quot;../src/rw_Metropolis.cpp&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;C:/
## Users/DRZCW/Desktop/StatComp20062/src/../inst/include&quot;: 系统找不到指定的文件。</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">dLaplace &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb82-2" title="2">  y &lt;-<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb82-3" title="3">  <span class="kw">return</span>(y)</a>
<a class="sourceLine" id="cb82-4" title="4">}</a>
<a class="sourceLine" id="cb82-5" title="5">rw.Metropolis.L &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb82-6" title="6">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb82-7" title="7">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb82-8" title="8">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb82-9" title="9">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb82-10" title="10">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb82-11" title="11">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb82-12" title="12">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dLaplace</span>(y)<span class="op">/</span><span class="kw">dLaplace</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb82-13" title="13">      x[i] &lt;-<span class="st"> </span>y  </a>
<a class="sourceLine" id="cb82-14" title="14">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb82-15" title="15">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb82-16" title="16">      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb82-17" title="17">    }</a>
<a class="sourceLine" id="cb82-18" title="18">  }</a>
<a class="sourceLine" id="cb82-19" title="19">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb82-20" title="20">}</a>
<a class="sourceLine" id="cb82-21" title="21"></a>
<a class="sourceLine" id="cb82-22" title="22">n &lt;-<span class="st"> </span><span class="dv">4</span>  <span class="co">#degrees of freedom for target Student t dist.</span></a>
<a class="sourceLine" id="cb82-23" title="23">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb82-24" title="24">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb82-25" title="25">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>,  <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb82-26" title="26"></a>
<a class="sourceLine" id="cb82-27" title="27">rw2L &lt;-<span class="st"> </span><span class="kw">rw.Metropolis.L</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb82-28" title="28">rw2C &lt;-<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb82-29" title="29"><span class="kw">qqplot</span>(rw2C<span class="op">$</span>x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">800</span>)],rw2L<span class="op">$</span>x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">800</span>)])</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">library</span>(microbenchmark)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw2L =</span> <span class="kw">rw.Metropolis.L</span>(sigma[<span class="dv">2</span>], x0, N), <span class="dt">rw2C =</span> <span class="kw">rw_Metropolis</span>(sigma[<span class="dv">2</span>], x0, N))</a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr       lq   median        uq
## 1 rw2L 7267.680 7423.412 7667.5695
## 2 rw2C  455.748  464.235  473.1175</code></pre>
<p>Summary:the corresponding generated random numbers are close to those by the R function, but the generating speed is more fast.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>

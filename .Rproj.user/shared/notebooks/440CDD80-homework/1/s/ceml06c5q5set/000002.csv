"0","library(knitr)"
"0","set.seed(12345)"
"0","dLaplace <- function(x){"
"0","  y <- 0.5*exp(-abs(x))"
"0","  return(y)"
"0","}"
"0",""
"0","rw.Metropolis.L <- function(sigma, x0, N) {"
"0","  x <- numeric(N)"
"0","  x[1] <- x0"
"0","  u <- runif(N)"
"0","  k <- 0"
"0","  for (i in 2:N) {"
"0","    y <- rnorm(1, x[i-1], sigma)"
"0","    if (u[i] <= (dLaplace(y)/dLaplace(x[i-1])))"
"0","      x[i] <- y  "
"0","    else {"
"0","      x[i] <- x[i-1]"
"0","      k <- k + 1"
"0","    }"
"0","  }"
"0","  return(list(x=x, k=k))"
"0","}"
"0",""
"0","n <- 4  #degrees of freedom for target Student t dist."
"0","N <- 2000"
"0","sigma <- c(.05, .5, 2,  16)"
"0",""
"0","x0 <- 25"
"0","rw1 <- rw.Metropolis.L(sigma[1], x0, N)"
"0","rw2 <- rw.Metropolis.L(sigma[2], x0, N)"
"0","rw3 <- rw.Metropolis.L(sigma[3], x0, N)"
"0","rw4 <- rw.Metropolis.L(sigma[4], x0, N)"
"0","reject <- c(rw1$k, rw2$k, rw3$k, rw4$k)"
"0","no.reject <- NULL"
"0","#number of candidate points rejected"
"0","no.reject <- data.frame(sigma=sigma,no.reject=reject,accepted.rate=(N-reject)/N)"
"0","knitr::kable(no.reject)"
